==== LINO SKELETON AUDIT ====
Wed Jan 28 01:15:00 CET 2026

## 0) ENV / PY
/home/tng25/lino/.venv/bin/python
Python 3.12.3
VENV=/home/tng25/lino/.venv

## 1) TREE (top)
total 7888
drwxr-xr-x 7 tng25 tng25    4096 Jan 28 00:33 .
drwxr-x--- 8 tng25 tng25    4096 Jan 27 23:11 ..
-rw-r--r-- 1 tng25 tng25    3922 Jan 28 00:33 .env.real
-rw------- 1 tng25 tng25    1335 Jan 25 14:57 .env.real.bak_deadmarket_2026-01-25_145723
-rw------- 1 tng25 tng25    1327 Jan 25 14:07 .env.real.bak_risk_2026-01-25_140723
-rw-r--r-- 1 tng25 tng25     241 Jan 26 15:23 .gitignore
drwxr-xr-x 5 tng25 tng25    4096 Dec 23 00:11 .venv
drwxr-xr-x 3 tng25 tng25    4096 Jan 28 01:08 config
drwxr-xr-x 3 tng25 tng25   16384 Jan 28 01:08 core
-rwxr-xr-x 1 tng25 tng25    5779 Dec 23 00:10 dashboard.py
-rw-r--r-- 1 tng25 tng25     386 Jan 26 15:36 dev_db.json
-rwxr-xr-x 1 tng25 tng25     666 Dec 23 00:10 install_lino.sh
-rwxr-xr-x 1 tng25 tng25     229 Dec 23 00:10 keypair.json
-rw-r--r-- 1 tng25 tng25   16641 Jan 28 00:46 last_swap_debug.txt
-rw-r--r-- 1 tng25 tng25     276 Jan 28 00:46 last_swap_meta.json
-rw-r--r-- 1 tng25 tng25     808 Jan 28 00:46 last_swap_tx.b64
-rw-r--r-- 1 tng25 tng25 1463856 Jan 28 01:14 lino.log
-rw-r--r-- 1 tng25 tng25 1995958 Jan 26 13:04 lino.log.1
-rw-r--r-- 1 tng25 tng25 1995394 Jan 26 11:22 lino.log.2
-rw-r--r-- 1 tng25 tng25 1996459 Jan 26 08:46 lino.log.3
-rw-r--r-- 1 tng25 tng25  259171 Jan 25 14:11 lino.log.bak_2026-01-25_141129
-rw-r--r-- 1 tng25 tng25       4 Jan 24 21:10 lino.pid
-rw-r--r-- 1 tng25 tng25   88623 Jan 24 23:56 lino_real.log
-rw-r--r-- 1 tng25 tng25     101 Jan 27 02:58 mints_consumer_state.json
-rw-r--r-- 1 tng25 tng25     357 Jan 27 01:57 mints_found.json
-rwxr-xr-x 1 tng25 tng25    3161 Jan 24 21:22 one_shot_ready.sh
-rw-r--r-- 1 tng25 tng25    4566 Jan 25 03:55 patch_dex_price.py
-rw-r--r-- 1 tng25 tng25       0 Jan 24 14:42 pos.entry_price
-rw-r--r-- 1 tng25 tng25    4261 Jan 20 17:23 positions.backup.json
-rw-r--r-- 1 tng25 tng25    3339 Jan 26 15:11 positions.json
-rw-r--r-- 1 tng25 tng25     392 Jan 24 23:03 positions.json.backup.1769296781
-rwxr-xr-x 1 tng25 tng25     270 Jan  5 22:43 positions.json.bak
-rw-r--r-- 1 tng25 tng25    1580 Jan 24 22:41 positions.json.bak_2026-01-24_224133
-rw-r--r-- 1 tng25 tng25   26637 Jan 26 18:30 pumpfun_dev_db.json
-rw-r--r-- 1 tng25 tng25     402 Jan 27 14:15 ready_to_trade.bak.jsonl
-rw-r--r-- 1 tng25 tng25   30199 Jan 27 16:33 ready_to_trade.jsonl
-rw-r--r-- 1 tng25 tng25     560 Jan 26 15:11 recent_sells.json
-rw-r--r-- 1 tng25 tng25     141 Jan 24 23:03 recent_sells.json.backup.1769296792
drwxr-xr-x 3 tng25 tng25    4096 Jan 28 01:08 src
drwxr-xr-x 3 tng25 tng25    4096 Jan 28 01:15 state
-rwxr-xr-x 1 tng25 tng25      82 Dec 23 00:10 test_import.py
-rw-r--r-- 1 tng25 tng25      27 Jan 27 02:30 trader_exec_state.json
-rw-r--r-- 1 tng25 tng25      22 Jan 27 22:41 trader_state.json

## 2) TREE (core/src/config/state)
core
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ __pycache__
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ alpha_filters.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ anti_rug.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ candidate_pipeline.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ dev_profiler.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ logger.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ paper_executor.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_listener.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_mint_resolver.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_tracker.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ quality.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ raydium_client.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ real_executor.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ risk_checks.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ solana_client.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ token_scanner.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trading.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trading.py.cpython-312.pyc
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wallet.cpython-312.pyc
‚îú‚îÄ‚îÄ alpha_filters.py
‚îú‚îÄ‚îÄ anti_rug.py
‚îú‚îÄ‚îÄ async_runner.py
‚îú‚îÄ‚îÄ birdeye_async.py
‚îú‚îÄ‚îÄ candidate_pipeline.py
‚îú‚îÄ‚îÄ dev_profiler.py
‚îú‚îÄ‚îÄ executor.py
‚îú‚îÄ‚îÄ geckoterminal_async.py
‚îú‚îÄ‚îÄ jupiter_async.py
‚îú‚îÄ‚îÄ jupiter_price_async.py
‚îú‚îÄ‚îÄ logger.py
‚îú‚îÄ‚îÄ logger.py.bak
‚îú‚îÄ‚îÄ logger.py.bak_logger_patch_2026-01-25_143635
‚îú‚îÄ‚îÄ logger.py.bak_nodup2_2026-01-25_143320
‚îú‚îÄ‚îÄ logger.py.bak_nodup_2026-01-25_142852
‚îú‚îÄ‚îÄ paper_executor.py
‚îú‚îÄ‚îÄ paper_executor.py.bak.1769263883
‚îú‚îÄ‚îÄ paper_executor.py.bak_2026-01-24_224934
‚îú‚îÄ‚îÄ pumpfun_listener.py
‚îú‚îÄ‚îÄ pumpfun_mint_resolver.py
‚îú‚îÄ‚îÄ pumpfun_onchain.py
‚îú‚îÄ‚îÄ pumpfun_tracker.py
‚îú‚îÄ‚îÄ quality.py
‚îú‚îÄ‚îÄ raydium_client.py
‚îú‚îÄ‚îÄ raydium_client.py.bak
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769213709
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769213975
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769214168
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769214281
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769214528
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769215176
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769263017
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769267779
‚îú‚îÄ‚îÄ raydium_client.py.bak.1769281222
‚îú‚îÄ‚îÄ raydium_client.py.bak.fix.1769281447
‚îú‚îÄ‚îÄ raydium_client.py.bak.fixheaders.1769282187
‚îú‚îÄ‚îÄ raydium_client.py.bak.headersfix.1769281798
‚îú‚îÄ‚îÄ raydium_client.py.bak.sendraw.1769255917
‚îú‚îÄ‚îÄ raydium_client.py.bak.sendtx.1769217568
‚îú‚îÄ‚îÄ raydium_client.py.bak.sigfix.1769256211
‚îú‚îÄ‚îÄ raydium_client.py.bak.signers.1769256975
‚îú‚îÄ‚îÄ raydium_client.py.bak.signfix.1769216502
‚îú‚îÄ‚îÄ raydium_client.py.bak.signfix.1769264932
‚îú‚îÄ‚îÄ raydium_client.py.bak.signsend.1769216985
‚îú‚îÄ‚îÄ raydium_client.py.bak.signsend.1769217157
‚îú‚îÄ‚îÄ raydium_client.py.bak.signv0.1769256663
‚îú‚îÄ‚îÄ raydium_client.py.bak.v0tx.1769216846
‚îú‚îÄ‚îÄ real_executor.py
‚îú‚îÄ‚îÄ real_executor.py.bak.1769201424
‚îú‚îÄ‚îÄ real_executor.py.bak.1769210013
‚îú‚îÄ‚îÄ real_executor.py.bak.1769210597
‚îú‚îÄ‚îÄ real_executor.py.bak.1769213449
‚îú‚îÄ‚îÄ real_executor.py.bak.1769213700
‚îú‚îÄ‚îÄ real_executor.py.bak.1769262998
‚îú‚îÄ‚îÄ real_executor.py.bak.1769263883
‚îú‚îÄ‚îÄ real_executor.py.bak.1769266219
‚îú‚îÄ‚îÄ real_executor.py.bak.1769267423
‚îú‚îÄ‚îÄ real_executor.py.bak.1769267573
‚îú‚îÄ‚îÄ real_executor.py.bak.1769267779
‚îú‚îÄ‚îÄ real_executor.py.bak_2026-01-24_224925
‚îú‚îÄ‚îÄ risk_checks.py
‚îú‚îÄ‚îÄ risk_checks.py.bak
‚îú‚îÄ‚îÄ risk_checks.py.bak.1769201424
‚îú‚îÄ‚îÄ solana_client.py
‚îú‚îÄ‚îÄ solana_client.py.bak.1769255340
‚îú‚îÄ‚îÄ solana_client.py.bak.1769255623
‚îú‚îÄ‚îÄ solana_client.py.bak.1769286167
‚îú‚îÄ‚îÄ solana_rpc_async.py
‚îú‚îÄ‚îÄ token_scanner.py
‚îú‚îÄ‚îÄ token_scanner.py.BROKEN_2026-01-26_031647.bak
‚îú‚îÄ‚îÄ token_scanner.py.bak.1768937148
‚îú‚îÄ‚îÄ token_scanner.py.bak.1769170533
‚îú‚îÄ‚îÄ token_scanner.py.bak.1769280726
‚îú‚îÄ‚îÄ token_scanner.py.bak.filternone.1769216165
‚îú‚îÄ‚îÄ token_scanner.py.bak.raydiumonly.1769216158
‚îú‚îÄ‚îÄ token_scanner.py.bak_2026-01-25_230047
‚îú‚îÄ‚îÄ token_scanner.py.bak_2026-01-26_004801
‚îú‚îÄ‚îÄ token_scanner.py.bak_2026-01-26_044833
‚îú‚îÄ‚îÄ token_scanner.py.bak_add_data_2026-01-26_035026
‚îú‚îÄ‚îÄ token_scanner.py.bak_aliasfix_2026-01-26_033600
‚îú‚îÄ‚îÄ token_scanner.py.bak_cfgfix_2026-01-26_044507
‚îú‚îÄ‚îÄ token_scanner.py.bak_cfgkwargs_2026-01-26_013836
‚îú‚îÄ‚îÄ token_scanner.py.bak_clean_2026-01-26_043758
‚îú‚îÄ‚îÄ token_scanner.py.bak_cleanup_norm_2026-01-26_055013
‚îú‚îÄ‚îÄ token_scanner.py.bak_dexfallback_2026-01-26_003537
‚îú‚îÄ‚îÄ token_scanner.py.bak_dns_failsoft_2026-01-25_160351
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_cfg_2026-01-26_001257
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_conc_2026-01-26_002204
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_dexurl_2026-01-26_001000
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_missing_2026-01-26_014513
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_missing_2026-01-26_014522
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_scan_2026-01-26_002838
‚îú‚îÄ‚îÄ token_scanner.py.bak_fix_scannerconfig_2026-01-26_011950
‚îú‚îÄ‚îÄ token_scanner.py.bak_force_data_2026-01-26_041022
‚îú‚îÄ‚îÄ token_scanner.py.bak_full_2026-01-26_010911
‚îú‚îÄ‚îÄ token_scanner.py.bak_headers_2026-01-26_001018
‚îú‚îÄ‚îÄ token_scanner.py.bak_market_quality_2026-01-25_221610
‚îú‚îÄ‚îÄ token_scanner.py.bak_norm_keys_2026-01-26_052828
‚îú‚îÄ‚îÄ token_scanner.py.bak_normkeys2_2026-01-26_053953
‚îú‚îÄ‚îÄ token_scanner.py.bak_normkeys3_2026-01-26_054623
‚îú‚îÄ‚îÄ token_scanner.py.bak_overviewfix_2026-01-26_032834
‚îú‚îÄ‚îÄ token_scanner.py.bak_rewrite_2026-01-26_034617
‚îú‚îÄ‚îÄ trading.py
‚îú‚îÄ‚îÄ trading.py.BROKEN
‚îú‚îÄ‚îÄ trading.py.autofix_2026-01-25_232141.bak
‚îú‚îÄ‚îÄ trading.py.bak
‚îú‚îÄ‚îÄ trading.py.bak.1769207330
‚îú‚îÄ‚îÄ trading.py.bak.1769207465
‚îú‚îÄ‚îÄ trading.py.bak.1769210210
‚îú‚îÄ‚îÄ trading.py.bak.1769210350
‚îú‚îÄ‚îÄ trading.py.bak.1769213683
‚îú‚îÄ‚îÄ trading.py.bak.1769213824
‚îú‚îÄ‚îÄ trading.py.bak.1769213990
‚îú‚îÄ‚îÄ trading.py.bak.1769214793
‚îú‚îÄ‚îÄ trading.py.bak.1769214803
‚îú‚îÄ‚îÄ trading.py.bak.1769262979
‚îú‚îÄ‚îÄ trading.py.bak.1769263883
‚îú‚îÄ‚îÄ trading.py.bak.1769264205
‚îú‚îÄ‚îÄ trading.py.bak.1769265095
‚îú‚îÄ‚îÄ trading.py.bak.1769265571
‚îú‚îÄ‚îÄ trading.py.bak.1769268091
‚îú‚îÄ‚îÄ trading.py.bak.1769280726
‚îú‚îÄ‚îÄ trading.py.bak.2026-01-26_144152
‚îú‚îÄ‚îÄ trading.py.bak.bad.1769286167
‚îú‚îÄ‚îÄ trading.py.bak.cooldown.1769283173
‚îú‚îÄ‚îÄ trading.py.bak.cooldownpersist.1769284517
‚îú‚îÄ‚îÄ trading.py.bak.dexfilter.1769215685
‚îú‚îÄ‚îÄ trading.py.bak.dexfilter2.1769215856
‚îú‚îÄ‚îÄ trading.py.bak.dexfilter3.1769215965
‚îú‚îÄ‚îÄ trading.py.bak.fix.1769207647
‚îú‚îÄ‚îÄ trading.py.bak.fixcooldownorder.1769285244
‚îú‚îÄ‚îÄ trading.py.bak.fixkeys.1769208985
‚îú‚îÄ‚îÄ trading.py.bak.fixsellts.1769283675
‚îú‚îÄ‚îÄ trading.py.bak.forcepersist.1769285101
‚îú‚îÄ‚îÄ trading.py.bak.persistcooldown.1769284223
‚îú‚îÄ‚îÄ trading.py.bak.strategy.1769261647
‚îú‚îÄ‚îÄ trading.py.bak_2026-01-24_222418
‚îú‚îÄ‚îÄ trading.py.bak_2026-01-25_011048
‚îú‚îÄ‚îÄ trading.py.bak_2026-01-25_230047
‚îú‚îÄ‚îÄ trading.py.bak_add_sellcooldown_2026-01-25_012259
‚îú‚îÄ‚îÄ trading.py.bak_alpha_2026-01-25_223115
‚îú‚îÄ‚îÄ trading.py.bak_before_dexpatch_2026-01-25_034254
‚îú‚îÄ‚îÄ trading.py.bak_before_nowfix_2026-01-25_234653
‚îú‚îÄ‚îÄ trading.py.bak_deadmarket_2026-01-25_145723
‚îú‚îÄ‚îÄ trading.py.bak_dexfallback_safe_2026-01-25_033354
‚îú‚îÄ‚îÄ trading.py.bak_dexfallback_safe_2026-01-25_033402
‚îú‚îÄ‚îÄ trading.py.bak_dexfallback_safe_2026-01-25_033933
‚îú‚îÄ‚îÄ trading.py.bak_dexpatch_ok_2026-01-25_035540
‚îú‚îÄ‚îÄ trading.py.bak_final_fix_2026-01-25_235357
‚îú‚îÄ‚îÄ trading.py.bak_fix__safe_builtins_2026-01-25_152702
‚îú‚îÄ‚îÄ trading.py.bak_fix_builtins_safe_float_2026-01-25_170020
‚îú‚îÄ‚îÄ trading.py.bak_fix_continue_2026-01-25_013243
‚îú‚îÄ‚îÄ trading.py.bak_fix_dead_float_2026-01-25_150959
‚îú‚îÄ‚îÄ trading.py.bak_fix_deadmarket_2026-01-25_160351
‚îú‚îÄ‚îÄ trading.py.bak_fix_empty_except_2026-01-25_144223
‚îú‚îÄ‚îÄ trading.py.bak_fix_float_now_2026-01-25_213504
‚îú‚îÄ‚îÄ trading.py.bak_fix_floatcall_2026-01-25_150355
‚îú‚îÄ‚îÄ trading.py.bak_fix_jup_parsev3_2026-01-25_134330
‚îú‚îÄ‚îÄ trading.py.bak_fix_jup_pricev3_2026-01-25_133921
‚îú‚îÄ‚îÄ trading.py.bak_fix_requests_2026-01-25_131226
‚îú‚îÄ‚îÄ trading.py.bak_fix_time_2026-01-25_230918
‚îú‚îÄ‚îÄ trading.py.bak_fixindent_2026-01-25_011429
‚îú‚îÄ‚îÄ trading.py.bak_fixindent_2026-01-25_011447
‚îú‚îÄ‚îÄ trading.py.bak_force_rm_requests_2026-01-25_132205
‚îú‚îÄ‚îÄ trading.py.bak_jup_refresh_2026-01-25_142852
‚îú‚îÄ‚îÄ trading.py.bak_jup_stale_fallback_2026-01-25_144608
‚îú‚îÄ‚îÄ trading.py.bak_market_quality_2026-01-25_221610
‚îú‚îÄ‚îÄ trading.py.bak_patch_dexprice_2026-01-25_032945
‚îú‚îÄ‚îÄ trading.py.bak_patch_dexprice_2026-01-25_032954
‚îú‚îÄ‚îÄ trading.py.bak_price_dedup_2026-01-25_143635
‚îú‚îÄ‚îÄ trading.py.bak_price_log_2026-01-25_142015
‚îú‚îÄ‚îÄ trading.py.bak_price_log_2026-01-25_142108
‚îú‚îÄ‚îÄ trading.py.bak_pricefallback_2026-01-25_032551
‚îú‚îÄ‚îÄ trading.py.bak_pricefallback_2026-01-25_032624
‚îú‚îÄ‚îÄ trading.py.bak_rm_bad_import_2026-01-25_131647
‚îú‚îÄ‚îÄ trading.py.bak_rm_badblock_2026-01-25_011842
‚îú‚îÄ‚îÄ trading.py.bak_rm_price_dups_2026-01-25_143940
‚îú‚îÄ‚îÄ trading.py.bak_tp_2026-01-24_224956
‚îú‚îÄ‚îÄ trading.py.corrupt.bak.1769264373
‚îú‚îÄ‚îÄ wallet.py
‚îú‚îÄ‚îÄ wallet.py.bak.1769255197
‚îî‚îÄ‚îÄ wallet_manager.py
src
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ __pycache__
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ config.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ mints_consumer_jup.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pnl_tracker.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ positions.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ price_feed.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pump_rider.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_poller2.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_poller3.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_poller4.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pumpfun_test.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ risk_engine.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ rpc_client.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ rpc_token_balance.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ run_live.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ sell_engine.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ store.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ strategy.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ test_jupiter_swap.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_exec.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_exit.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_jup.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_loop.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_sell.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_send.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_sign.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ trader_simulate.cpython-312.pyc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ universe_builder.cpython-312.pyc
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ xxx.cpython-312.pyc
‚îú‚îÄ‚îÄ config_legacy.py
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ main.py.bak
‚îú‚îÄ‚îÄ main.py.bak.fix.1769207974
‚îú‚îÄ‚îÄ main.py.bak.fixloop.1769208543
‚îú‚îÄ‚îÄ main.py.bak.fixloop2.1769208657
‚îú‚îÄ‚îÄ main.py.bak_api_fix_2026-01-25_023024
‚îú‚îÄ‚îÄ main.py.bak_env_2026-01-25_020937
‚îú‚îÄ‚îÄ main.py.bak_fix_new_listing_2026-01-26_020409
‚îú‚îÄ‚îÄ main.py.bak_fixindent_api_2026-01-25_023422
‚îú‚îÄ‚îÄ main.py.bak_indentfix
‚îú‚îÄ‚îÄ main.py.bak_indentfix2
‚îú‚îÄ‚îÄ main.py.bak_noblock_api_2026-01-25_022602
‚îú‚îÄ‚îÄ mints_consumer_jup.py
‚îú‚îÄ‚îÄ pnl_tracker.py
‚îú‚îÄ‚îÄ positions.py
‚îú‚îÄ‚îÄ price_feed.py
‚îú‚îÄ‚îÄ pump_rider.py
‚îú‚îÄ‚îÄ pumpfun_live.py
‚îú‚îÄ‚îÄ pumpfun_poller.py
‚îú‚îÄ‚îÄ pumpfun_poller2.py
‚îú‚îÄ‚îÄ pumpfun_poller3.py
‚îú‚îÄ‚îÄ pumpfun_poller4.py
‚îú‚îÄ‚îÄ pumpfun_test.py
‚îú‚îÄ‚îÄ risk_engine.py
‚îú‚îÄ‚îÄ rpc_client.py
‚îú‚îÄ‚îÄ rpc_token_balance.py
‚îú‚îÄ‚îÄ run_live.py
‚îú‚îÄ‚îÄ sell_engine.py
‚îú‚îÄ‚îÄ store.py
‚îú‚îÄ‚îÄ strategy.py
‚îú‚îÄ‚îÄ test_jupiter_swap.py
‚îú‚îÄ‚îÄ trader_exec.py
‚îú‚îÄ‚îÄ trader_exit.py
‚îú‚îÄ‚îÄ trader_jup.py
‚îú‚îÄ‚îÄ trader_loop.py
‚îú‚îÄ‚îÄ trader_sell.py
‚îú‚îÄ‚îÄ trader_send.py
‚îú‚îÄ‚îÄ trader_sign.py
‚îú‚îÄ‚îÄ trader_simulate.py
‚îú‚îÄ‚îÄ universe_builder.py
‚îî‚îÄ‚îÄ xxx.py
config
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ __pycache__
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.cpython-312.pyc
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ settings.cpython-312.pyc
‚îú‚îÄ‚îÄ settings.py
‚îú‚îÄ‚îÄ settings.py.BACKUP_2026-01-26_031712.bak
‚îú‚îÄ‚îÄ settings.py.bak
‚îú‚îÄ‚îÄ settings.py.bak.1768937148
‚îú‚îÄ‚îÄ settings.py.bak.mintcooldown.1769261817
‚îú‚îÄ‚îÄ settings.py.bak_2026-01-25_230047
‚îú‚îÄ‚îÄ settings.py.bak_2026-01-26_004739
‚îú‚îÄ‚îÄ settings.py.bak_2026-01-26_050341
‚îú‚îÄ‚îÄ settings.py.bak_deadmarket_2026-01-25_145723
‚îú‚îÄ‚îÄ settings.py.bak_defaults_2026-01-26_002213
‚îú‚îÄ‚îÄ settings.py.bak_defaults_2026-01-26_002224
‚îú‚îÄ‚îÄ settings.py.bak_scan_2026-01-26_002859
‚îú‚îÄ‚îÄ settings.py.bak_scanner_2026-01-26_003550
‚îú‚îÄ‚îÄ settings.py.bak_scanner_2026-01-26_044142
‚îî‚îÄ‚îÄ settings.py.bak_trailing_2026-01-25_140210
state
‚îú‚îÄ‚îÄ SKELETON_REPORT.txt
‚îú‚îÄ‚îÄ backup_2026-01-28_010810
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ config.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ risk_checks.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ trading.py
‚îú‚îÄ‚îÄ blacklist_dev.json
‚îú‚îÄ‚îÄ blacklist_mint.json
‚îú‚îÄ‚îÄ notes_dump.txt
‚îú‚îÄ‚îÄ schema.sql
‚îú‚îÄ‚îÄ seed_mints.txt
‚îú‚îÄ‚îÄ trader_loop_state.json
‚îú‚îÄ‚îÄ trades.sqlite
‚îî‚îÄ‚îÄ universe_cache.json

8 directories, 306 files

## 3) ENTRYPOINTS / RUNNERS
### src/run_live.py
import os
import threading
import time

from trader_loop import trader_loop
from sell_engine import sell_engine


def _ensure_alias_env():
    # Jupiter
    os.environ.setdefault("JUP_BASE", os.getenv("JUPITER_BASE_URL", "https://api.jup.ag"))
    os.environ.setdefault("JUP_TOKENS_BASE", os.getenv("JUP_TOKENS_BASE", os.environ["JUP_BASE"].rstrip("/") + "/tokens/v2"))
    os.environ.setdefault("JUP_API_KEY", os.getenv("JUP_API_KEY", os.getenv("JUPITER_API_KEY", "")))

    # RPC
    os.environ.setdefault("RPC_HTTP", os.getenv("RPC_HTTP", os.getenv("RPC_URL", "https://api.mainnet-beta.solana.com")))

    # Wallet pubkey
    os.environ.setdefault("WALLET_PUBKEY", os.getenv("WALLET_PUBKEY", os.getenv("TRADER_USER_PUBLIC_KEY", "")))

    # Trade sizing / slippage
    os.environ.setdefault("TRADER_SOL_AMOUNT", os.getenv("TRADER_SOL_AMOUNT", os.getenv("BUY_AMOUNT_SOL", "0.01")))
    os.environ.setdefault("TRADER_SLIPPAGE_BPS", os.getenv("TRADER_SLIPPAGE_BPS", os.getenv("SLIPPAGE_BPS", "120")))
    os.environ.setdefault("TRADER_MAX_PRICE_IMPACT_PCT", os.getenv("TRADER_MAX_PRICE_IMPACT_PCT", os.getenv("MAX_PRICE_IMPACT_PCT", "1.5")))


def main():
    _ensure_alias_env()

    print("üöÄ run_live: starting sell_engine + trader_loop", flush=True)

    # sell_engine en background (sinon il bloque)
    t = threading.Thread(target=sell_engine, name="sell_engine", daemon=True)
    t.start()

    # petite pause pour logs
    time.sleep(0.2)

    # trader loop au premier plan
    trader_loop()


if __name__ == "__main__":
    main()

### src/main.py
from __future__ import annotations

import asyncio
import os
import sys
from typing import Any, Dict, List

# Assure les imports "core.*" et "config.*"
PROJECT_ROOT = os.path.abspath(os.path.join(os.path.dirname(__file__), ".."))
from dotenv import load_dotenv
# Auto-load env (API keys, base URLs)
try:
    load_dotenv(os.path.join(PROJECT_ROOT, '.env.real'), override=True)
except Exception:
    pass

if PROJECT_ROOT not in sys.path:
    sys.path.insert(0, PROJECT_ROOT)

from config import settings
from core.logger import get_logger
from core.wallet import Wallet
from core.risk_checks import RiskChecker
from core.trading import TradingEngine
from core.token_scanner import TokenScanner, ScannerConfig


ASCII_LINO = r"""
‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
L I N O   B O T
"""


def _get_float(name: str, default: float) -> float:
    v = os.getenv(name)
    if not v:
        return default
    try:
        return float(v)
    except Exception:
        return default


async def run_loop() -> None:
    logger = get_logger()

    logger.info(f"Bot Lino d√©marr√© en mode {settings.MODE}")
    logger.info(ASCII_LINO)

    wallet = Wallet()
    logger.info(f"[WALLET] Loaded keypair with pubkey: {wallet.pubkey()}")

    risks = RiskChecker(logger=logger, rpc_url=settings.RPC_URL, mode=settings.MODE)

    engine = TradingEngine(
        wallet=wallet,
        logger=logger,
        positions_file=os.path.join(PROJECT_ROOT, "positions.json"),
        mode=settings.MODE,
    )

    # -------- Scanner --------
    # -------- Jupiter API KEY (ne doit plus bloquer le bot) --------
    # On accepte plusieurs noms pour √©viter "on me redemande la cl√©"
    jup_key = (
        os.getenv("JUPITER_API_KEY")
        or os.getenv("JUP_API_KEY")
        or os.getenv("JUPITER_KEY")
        or getattr(settings, "JUPITER_API_KEY", "")
        or getattr(settings, "JUP_API_KEY", "")
    )
    if not jup_key:
        logger.warning("[WARN] Aucune cl√© Jupiter trouv√©e. Le bot continue (scanner DexScreener OK), mais swaps/quotes Jupiter peuvent √©chouer.")

    cfg = ScannerConfig(
        new_listing_limit=int(getattr(settings, "NEW_LISTING_LIMIT", 5)),
        global_rps=float(getattr(settings, "GLOBAL_RPS", 0.2)),
        max_concurrency=int(getattr(settings, "MAX_CONCURRENCY", 1)),
        min_liquidity_usd=_get_float("MIN_LIQUIDITY_USD", 1000.0),
        max_market_cap_usd=_get_float("MAX_MARKET_CAP_USD", 300000.0),
    )

    scanner = TokenScanner(cfg)
    logger.info(
        f"[Scanner] ‚úÖ limit={getattr(cfg, "new_listing_limit", getattr(cfg, "scan_limit", 30))} rps={cfg.global_rps} conc={cfg.max_concurrency}"
    )

    try:
        while True:
            try:
                overviews: List[Dict[str, Any]] = await scanner.scan_once_async()
                logger.info(f"[DBG_OV] {overviews[:2]}")
                logger.info(f"[Main] overviews re√ßus: {len(overviews)}")
            except Exception as e:
                logger.error(f"[TokenScanner] scan error: {e}", exc_info=True)
                overviews = []

            # üî• TOUJOURS appeler l‚Äôengine, m√™me si overviews est vide
            logger.info(
                f"[DBG_MAIN_BEFORE_ENGINE] calling engine.on_overviews n={len(overviews)}"
            )
            await engine.on_overviews(overviews, risks)

            await asyncio.sleep(getattr(settings, "SCAN_INTERVAL_SECONDS", 25))

    except KeyboardInterrupt:
        logger.info("Arr√™t demand√© (CTRL+C).")
    finally:
        try:
            await scanner.aclose()
        except Exception:
            pass
        logger.info("Bot Lino arr√™t√©.")



### src/trader_loop.py
import os
import time
import subprocess
from pathlib import Path

def trader_loop():
    sleep_s = float(os.getenv("LOOP_SLEEP_S", os.getenv("SCAN_INTERVAL_SECONDS", "12")))
    max_trades_per_hour = int(os.getenv("LOOP_MAX_TRADES_PER_HOUR", "6"))
    cooldown_s = int(os.getenv("LOOP_COOLDOWN_MINT_S", "1800"))

    one_shot = os.getenv("TRADER_ONE_SHOT", "0").strip().lower() in ("1","true","yes","on")

    print("üß† trader_loop (universe_builder -> exec -> sign -> send)")
    print("   sleep_s=", sleep_s, "max_trades/h=", max_trades_per_hour, "cooldown_s=", cooldown_s)

    # NOTE: on garde ta logique existante "ready_to_trade.jsonl"
    # Ici on fait simple: on construit/execute 1 trade par tick via trader_exec.py
    tries = 0
    while True:
        tries += 1

        # call trader_exec
        try:
            proc = subprocess.run(
                ["python", "src/trader_exec.py"],
                check=False,
                capture_output=False,
                text=True,
            )
        except Exception as e:
            print("‚ùå trader_loop cannot run trader_exec:", e)

        if one_shot:
            print("üß™ ONE_SHOT=1 -> stop after one iteration")
            return

        time.sleep(sleep_s)

### src/trader_exec.py
import os, json, time
from pathlib import Path
from typing import Any, Dict, List, Optional
import requests

READY_FILE = os.getenv("TRADER_READY_FILE", "ready_to_trade.jsonl")

JUP_BASE = os.getenv("JUP_BASE", os.getenv("JUPITER_BASE_URL", "https://api.jup.ag")).rstrip("/")
JUP_API_KEY = os.getenv("JUP_API_KEY", os.getenv("JUPITER_API_KEY", "")).strip()

RPC_HTTP = os.getenv("RPC_HTTP", os.getenv("RPC_URL", "https://api.mainnet-beta.solana.com")).strip()

SLIPPAGE_BPS = int(os.getenv("TRADER_SLIPPAGE_BPS", os.getenv("SLIPPAGE_BPS", "120")))
MAX_PRICE_IMPACT_PCT = float(os.getenv("TRADER_MAX_PRICE_IMPACT_PCT", os.getenv("MAX_PRICE_IMPACT_PCT", "1.5")))

ONE_SHOT = os.getenv("TRADER_ONE_SHOT", "0").strip().lower() in ("1","true","yes","on")
DRY_RUN = os.getenv("TRADER_DRY_RUN", "1").strip().lower() in ("1","true","yes","on")

DEFAULT_SOL_AMOUNT = float(os.getenv("TRADER_SOL_AMOUNT", os.getenv("BUY_AMOUNT_SOL", "0.01")))

OUT_TX_B64 = Path("last_swap_tx.b64")
OUT_META = Path("last_swap_meta.json")
OUT_ERR = Path("last_swap_error.json")
OUT_DBG = Path("last_swap_debug.txt")

SOL_MINT = "So11111111111111111111111111111111111111112"

def _headers() -> Dict[str, str]:
    h = {"accept": "application/json", "content-type": "application/json"}
    if JUP_API_KEY:
        h["x-api-key"] = JUP_API_KEY
    return h

def _write_err(where: str, payload: Any):
    OUT_ERR.write_text(json.dumps({"where": where, "payload": payload}, ensure_ascii=False, indent=2), encoding="utf-8")

def _append_dbg(s: str):
    OUT_DBG.write_text((OUT_DBG.read_text(encoding="utf-8") if OUT_DBG.exists() else "") + s + "\n", encoding="utf-8")

def _load_ready() -> List[Dict[str, Any]]:
    p = Path(READY_FILE)
    if not p.exists():
        return []
    arr: List[Dict[str, Any]] = []
    for ln in p.read_text(encoding="utf-8").splitlines():
        ln = ln.strip()
        if not ln:
            continue
        try:
            obj = json.loads(ln)
            if isinstance(obj, dict):
                arr.append(obj)
        except Exception:
            continue
    return arr

def _pick_user_pubkey() -> str:
    for k in ("WALLET_PUBKEY","TRADER_USER_PUBLIC_KEY","TRADER_USER_PUBKEY","USER_PUBKEY","PUBLIC_KEY","WALLET_PUBLIC_KEY"):
        v = os.getenv(k, "").strip()
        if v:
            return v
    return ""

def _lamports_from_any(x: Any) -> Optional[int]:
    try:
        if x is None:
            return None
        if isinstance(x, int):
            return int(x)
        s = str(x).strip()
        if not s:
            return None
        if "." in s:
            return int(float(s) * 1_000_000_000)  # SOL -> lamports
        return int(s)
    except Exception:
        return None

def _get_token_amount_for_sell(mint: str) -> Optional[int]:
    """
    On lit l'amount token √† vendre depuis env:
      SELL_TOKEN_AMOUNT (raw) ou SELL_TOKEN_AMOUNT_UI (ui units) + SELL_TOKEN_DECIMALS
    Minimal pour avancer sans RPC token balance.
    """
    raw = os.getenv("SELL_TOKEN_AMOUNT", "").strip()
    if raw:
        try: return int(raw)
        except Exception: pass

    ui = os.getenv("SELL_TOKEN_AMOUNT_UI", "").strip()
    dec = os.getenv("SELL_TOKEN_DECIMALS", "").strip()
    if ui and dec:
        try:
            ui_f = float(ui)
            dec_i = int(dec)
            return int(ui_f * (10 ** dec_i))
        except Exception:
            return None
    return None

def main() -> int:
    sell_mode = os.getenv("SELL_MODE", "0").strip().lower() in ("1","true","yes","on")

    user_pubkey = _pick_user_pubkey()
    if not user_pubkey:
        _write_err("missing_user_pubkey", {"hint": "set WALLET_PUBKEY or TRADER_USER_PUBLIC_KEY"})
        print("‚ùå missing public key")
        return 0

    _append_dbg("==== trader_exec run ====")

    if sell_mode:
        sell_mint = os.getenv("SELL_MINT", "").strip()
        sell_fraction = float(os.getenv("SELL_FRACTION", "1.0"))
        sell_fraction = max(0.0, min(1.0, sell_fraction))

        if not sell_mint:
            _write_err("sell_missing_mint", {})
            print("‚ùå SELL_MODE=1 but SELL_MINT missing")
            return 0

### src/trader_sign.py
import base64
import json
import os
from pathlib import Path

# Inputs
IN_TX_B64_PATH = Path(os.getenv("TRADER_LAST_TX_B64_PATH", "last_swap_tx.b64"))
KEYPAIR_PATH = Path(os.getenv("TRADER_KEYPAIR_PATH", "keypair.json"))

# Outputs
OUT_SIGNED_TX_B64_PATH = Path(os.getenv("TRADER_SIGNED_TX_B64_PATH", "last_swap_tx.signed.b64"))

def load_keypair_bytes(path: Path) -> bytes:
    data = json.loads(path.read_text(encoding="utf-8"))
    if not isinstance(data, list) or len(data) < 64:
        raise ValueError("keypair.json invalide: attendu une liste de 64 ints")
    return bytes(int(x) & 0xFF for x in data[:64])

def main() -> None:
    if not IN_TX_B64_PATH.exists():
        raise SystemExit(f"‚ùå input tx missing: {IN_TX_B64_PATH}")
    if not KEYPAIR_PATH.exists():
        raise SystemExit(f"‚ùå keypair missing: {KEYPAIR_PATH}")

    try:
        from solders.keypair import Keypair
        from solders.transaction import VersionedTransaction
    except Exception as e:
        raise SystemExit(
            "‚ùå solders manquant. Fais:\n"
            "   pip install -U solders\n"
            f"   err={e}"
        )

    tx_b64 = IN_TX_B64_PATH.read_text(encoding="utf-8").strip()
    raw = base64.b64decode(tx_b64)

    kp = Keypair.from_bytes(load_keypair_bytes(KEYPAIR_PATH))

    # Parse unsigned tx
    tx = VersionedTransaction.from_bytes(raw)

    # ‚úÖ SIGN PROPERLY: rebuild a new VersionedTransaction using the same message + signer
    # This ensures signatures array length matches numRequiredSignatures.
    signed_tx = VersionedTransaction(tx.message, [kp])

    signed_raw = bytes(signed_tx)
    signed_b64 = base64.b64encode(signed_raw).decode("utf-8")

    OUT_SIGNED_TX_B64_PATH.write_text(signed_b64, encoding="utf-8")

    # txid = first signature (base58)
    import base58
    sig0 = base58.b58encode(bytes(signed_tx.signatures[0])).decode("utf-8")

    print("‚úÖ SIGN OK")
    print("   in :", str(IN_TX_B64_PATH))
    print("   out:", str(OUT_SIGNED_TX_B64_PATH))
    print("   tx_bytes:", len(raw))
    print("   signed_bytes:", len(signed_raw))
    print("   txid(sig0):", sig0)
    print("   signer pubkey:", str(kp.pubkey()))

if __name__ == "__main__":
    main()

### src/trader_send.py
import base64
import json
import os
import sqlite3
import time
from pathlib import Path

import requests

from src.price_feed import get_prices

RPC_HTTP = os.getenv("SOLANA_RPC_HTTP") or os.getenv("RPC_HTTP") or "https://api.mainnet-beta.solana.com"
SIGNED_FILE = Path(os.getenv("TRADER_SIGNED_FILE", "last_swap_tx.signed.b64"))
META_FILE = Path(os.getenv("TRADER_META_FILE", "last_swap_meta.json"))
DB_PATH = os.getenv("TRADES_DB_PATH", "state/trades.sqlite")

SKIP_PREFLIGHT = (os.getenv("TRADER_SKIP_PREFLIGHT", "0").strip().lower() in ("1","true","yes","on"))
MAX_RETRIES = int(os.getenv("TRADER_MAX_RETRIES", "3"))
TIMEOUT_S = int(os.getenv("TRADER_SEND_TIMEOUT_S", "60"))

CONFIRM_TIMEOUT_S = int(os.getenv("TRADER_CONFIRM_TIMEOUT_S", "60"))
CONFIRM_POLL_S = float(os.getenv("TRADER_CONFIRM_POLL_S", "2.0"))

def rpc(method: str, params: list):
    payload = {"jsonrpc":"2.0","id":1,"method":method,"params":params}
    r = requests.post(RPC_HTTP, json=payload, timeout=TIMEOUT_S)
    j = r.json()
    if "error" in j and j["error"]:
        raise RuntimeError(json.dumps(j["error"]))
    return j.get("result")

def read_b64_file(p: Path) -> bytes:
    b64 = p.read_text(encoding="utf-8").strip()
    return base64.b64decode(b64)

def load_meta() -> dict:
    if not META_FILE.exists():
        return {}
    return json.loads(META_FILE.read_text(encoding="utf-8"))

def ensure_db():
    Path(DB_PATH).parent.mkdir(parents=True, exist_ok=True)
    con = sqlite3.connect(DB_PATH)
    cur = con.cursor()
    cur.execute("""
    CREATE TABLE IF NOT EXISTS positions(
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      mint TEXT NOT NULL,
      status TEXT NOT NULL,
      entry_price REAL NOT NULL,
      peak_price REAL NOT NULL,
      size_sol REAL NOT NULL,
      tp_done INTEGER NOT NULL DEFAULT 0,
      entry_ts INTEGER NOT NULL,
      tx_sig TEXT NOT NULL DEFAULT ''
    )
    """)
    cur.execute("""
    CREATE TABLE IF NOT EXISTS events(
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      ts INTEGER NOT NULL,
      mint TEXT NOT NULL,
      status TEXT NOT NULL,
      err TEXT NOT NULL DEFAULT ''
    )
    """)
    con.commit()
    con.close()

def add_event(mint: str, status: str, err: str = ""):
    ensure_db()
    con = sqlite3.connect(DB_PATH)
    cur = con.cursor()
    cur.execute("INSERT INTO events(ts,mint,status,err) VALUES(?,?,?,?)",
                (int(time.time()), mint, status, err or ""))
    con.commit()
    con.close()

def insert_position(mint: str, status: str, entry_price_usd: float, size_sol: float, tx_sig: str):
    ensure_db()
    con = sqlite3.connect(DB_PATH)
    cur = con.cursor()
    ts = int(time.time())
    cur.execute(
        "INSERT INTO positions(mint,status,entry_price,peak_price,size_sol,tp_done,entry_ts,tx_sig) VALUES(?,?,?,?,?,?,?,?)",
        (mint, status, float(entry_price_usd), float(entry_price_usd), float(size_sol), 0, ts, tx_sig or "")
    )
    con.commit()
    con.close()

def derive_size_sol_from_meta(meta: dict) -> float:
    for k in ("inAmount_ui","inputAmount_ui","in_ui","inSol"):
        if k in meta:
            try: return float(meta[k])
            except Exception: pass
    for k in ("inAmount","inputAmount","in_amount"):
        if k in meta:
            try: return float(meta[k]) / 1e9
            except Exception: pass
    q = meta.get("quote") or {}
    if isinstance(q, dict):
        for k in ("inAmount","inputAmount"):
            if k in q:
                try: return float(q[k]) / 1e9
                except Exception: pass
    return 0.0

def get_mint_from_meta(meta: dict) -> str:
    for k in ("outputMint","outMint","mint","targetMint"):
        m = (meta.get(k) or "").strip()
        if m:
            return m
    q = meta.get("quote") or {}
    if isinstance(q, dict):
        for k in ("outputMint","outMint","mint"):
            m = (q.get(k) or "").strip()
            if m:
                return m
    return ""


### src/sell_engine.py
import os, json, time, sqlite3
from pathlib import Path
from typing import Optional, Dict, Any
import requests

DB_PATH = os.getenv("DB_PATH", os.getenv("TRADES_DB_PATH", "state/trades.sqlite"))
CHECK_INTERVAL = float(os.getenv("SELL_CHECK_INTERVAL", os.getenv("CHECK_INTERVAL", "8")))

# TP/Stops (tu peux override via .env.real)
STOP_LOSS_PCT = float(os.getenv("STOP_LOSS_PCT", "0.15"))                 # -15%
TRAILING_ACTIVATION_PCT = float(os.getenv("TRAILING_ACTIVATION_PCT", "0.03"))  # +3% active
TRAILING_FROM_HIGH_PCT = float(os.getenv("TRAILING_FROM_HIGH_PCT", "0.05"))    # -5% from peak

TP1_GAIN_PCT = float(os.getenv("TP1_GAIN_PCT", "0.25"))                   # +25%
TP1_SELL_FRAC = float(os.getenv("TP1_SELL_FRACTION_INITIAL", "0.50"))     # sell 50%
TP2_GAIN_PCT = float(os.getenv("TP2_GAIN_PCT", "0.60"))                   # +60%
TP2_SELL_FRAC = float(os.getenv("TP2_SELL_FRACTION_INITIAL", "0.25"))     # sell 25%

JUP_BASE = os.getenv("JUP_BASE", os.getenv("JUPITER_BASE_URL", "https://api.jup.ag")).rstrip("/")
JUP_API_KEY = os.getenv("JUP_API_KEY", os.getenv("JUPITER_API_KEY", "")).strip()
SOL_MINT = "So11111111111111111111111111111111111111112"

# pour estimer un prix token en SOL via quote
PRICE_SOL_IN_LAMPORTS = int(float(os.getenv("SELL_PRICE_PROBE_SOL", "0.01")) * 1_000_000_000)

def _headers():
    h={"accept":"application/json"}
    if JUP_API_KEY:
        h["x-api-key"]=JUP_API_KEY
    return h

def _db():
    Path(DB_PATH).parent.mkdir(parents=True, exist_ok=True)
    return sqlite3.connect(DB_PATH, timeout=30)

def _event(conn, ts: int, mint: str, status: str, err: str = "", data: Optional[Dict[str, Any]] = None):
    data = data or {}
    conn.execute(
        "INSERT INTO events(ts,mint,status,err,data_json,data) VALUES(?,?,?,?,?,?)",
        (ts, mint, status, err, json.dumps(data, ensure_ascii=False), json.dumps(data, ensure_ascii=False)),
    )
    conn.commit()

def _get_price_sol_per_token(mint: str) -> Optional[float]:
    """
    Approx price via Jupiter quote:
      input SOL amount -> output token amount
    price (SOL/token) = sol_in / token_out
    """
    try:
        url = f"{JUP_BASE}/swap/v1/quote"
        params = {
            "inputMint": SOL_MINT,
            "outputMint": mint,
            "amount": str(PRICE_SOL_IN_LAMPORTS),
            "slippageBps": "50",
        }
        r = requests.get(url, params=params, headers=_headers(), timeout=20)
        if r.status_code != 200:
            return None
        q = r.json()
        out_amt = float(q.get("outAmount") or 0)
        if out_amt <= 0:
            return None
        sol_in = PRICE_SOL_IN_LAMPORTS / 1_000_000_000
        return sol_in / out_amt
    except Exception:
        return None

def _load_positions(conn):
    cur = conn.execute("SELECT mint, entry_price, entry_ts, size_sol, peak_price, tp_done, status, meta_json FROM positions WHERE status='OPEN'")
    rows = cur.fetchall()
    out=[]
    for r in rows:
        out.append({
            "mint": r[0],
            "entry_price": float(r[1]),
            "entry_ts": int(r[2]),
            "size_sol": float(r[3]),
            "peak_price": (float(r[4]) if r[4] is not None else None),
            "tp_done": int(r[5] or 0),
            "status": r[6],
            "meta_json": r[7] or "",
        })
    return out

def _update_peak(conn, mint: str, peak: float):
    conn.execute("UPDATE positions SET peak_price=? WHERE mint=?", (peak, mint))
    conn.commit()

def _set_tp_done(conn, mint: str, tp_done: int):
    conn.execute("UPDATE positions SET tp_done=? WHERE mint=?", (tp_done, mint))
    conn.commit()

def _close_position(conn, mint: str, why: str):
    conn.execute("UPDATE positions SET status='CLOSED' WHERE mint=?", (mint,))
    conn.execute("UPDATE trades SET status=? WHERE mint=?", (why, mint))
    conn.commit()

def _ensure_trades_row(conn, mint: str):
    ts=int(time.time())
    conn.execute(
        "INSERT OR IGNORE INTO trades(mint, first_seen_ts, last_ts, status, last_error, payload_json) VALUES(?,?,?,?,?,?)",
        (mint, ts, ts, "OPEN", "", "{}")
    )
    conn.commit()

def _call_sell_build(mint: str, fraction: float, token_amount_raw: int):
    """
    On BUILD la tx de sell via trader_exec.py (mode SELL)
    SIGN/SEND = ta pipeline existante.
    """
    env = os.environ.copy()
    env["SELL_MODE"] = "1"
    env["SELL_MINT"] = mint
    env["SELL_FRACTION"] = str(fraction)
    env["SELL_TOKEN_AMOUNT"] = str(token_amount_raw)
    # one shot
    env["TRADER_ONE_SHOT"] = "1"


### src/universe_builder.py
import os
import json
from pathlib import Path
from typing import Any, Dict, List
import requests

JUP_BASE = os.getenv("JUP_BASE", "https://api.jup.ag").rstrip("/")
TOKENS_BASE = os.getenv("JUP_TOKENS_BASE", f"{JUP_BASE}/tokens/v2").rstrip("/")
JUP_API_KEY = os.getenv("JUP_API_KEY", "").strip()

TOP_N = int(os.getenv("UNIVERSE_TOP_N", "1200"))
MAX_OUT = int(os.getenv("UNIVERSE_MAX_OUT", "250"))

MIN_VOL_24H = float(os.getenv("UNIVERSE_MIN_VOL_24H", "50000"))
MIN_VOL_1H = float(os.getenv("UNIVERSE_MIN_VOL_1H", "5000"))
MIN_LIQ = float(os.getenv("UNIVERSE_MIN_LIQ", "40000"))
MIN_TRADERS_1H = int(os.getenv("UNIVERSE_MIN_TRADERS_1H", "20"))
MIN_HOLDERS = int(os.getenv("UNIVERSE_MIN_HOLDERS", "800"))
MIN_ORGANIC = float(os.getenv("UNIVERSE_MIN_ORGANIC", "35"))

REQUIRE_VERIFIED = os.getenv("UNIVERSE_REQUIRE_VERIFIED", "0").strip().lower() in ("1","true","yes","on")
REQUIRE_AUTH_DISABLED = os.getenv("UNIVERSE_REQUIRE_AUTH_DISABLED", "0").strip().lower() in ("1","true","yes","on")
MAX_TOP_HOLD_PCT = float(os.getenv("UNIVERSE_MAX_TOP_HOLD_PCT", "60"))
REJECT_DEBUG = os.getenv("UNIVERSE_REJECT_DEBUG", "0").strip().lower() in ("1","true","yes","on")

STATE_DIR = Path("state")
STATE_DIR.mkdir(parents=True, exist_ok=True)
CACHE_PATH = STATE_DIR / "universe_cache.json"

def _headers() -> Dict[str, str]:
    h = {"accept": "application/json"}
    if JUP_API_KEY:
        h["x-api-key"] = JUP_API_KEY
    return h

def _get_json(url: str, timeout: int = 20) -> Any:
    r = requests.get(url, headers=_headers(), timeout=timeout)
    r.raise_for_status()
    return r.json()

def _f(x: Any, d: float = 0.0) -> float:
    try:
        return d if x is None else float(x)
    except Exception:
        return d

def _i(x: Any, d: int = 0) -> int:
    try:
        return d if x is None else int(x)
    except Exception:
        return d

def fetch_feed(feed: str, interval: str, limit: int = 100) -> List[Dict[str, Any]]:
    url = f"{TOKENS_BASE}/{feed}/{interval}?limit={limit}"
    data = _get_json(url)
    if isinstance(data, list):
        return data
    if isinstance(data, dict):
        for k in ("data","result","items","tokens"):
            v = data.get(k)
            if isinstance(v, list):
                return v
    return []

def build_universe() -> List[Dict[str, Any]]:
    print("üß† universe_builder")
    print("   jup_base=", JUP_BASE)
    print("   tokens_base=", TOKENS_BASE)
    print(f"   top_n= {TOP_N} max_out= {MAX_OUT}")
    print(f"   filters: daily_vol>= {MIN_VOL_24H} liq>= {MIN_LIQ} vol1h>= {MIN_VOL_1H} "
          f"traders1h>= {MIN_TRADERS_1H} holders>= {MIN_HOLDERS} organic>= {MIN_ORGANIC} "
          f"verified= {REQUIRE_VERIFIED} auth_disabled= {REQUIRE_AUTH_DISABLED} topHold%<= {MAX_TOP_HOLD_PCT}")

    feeds = [
        ("toptraded", "24h", 100),
        ("toptrending", "1h", 100),
        ("toporganicscore", "24h", 100),
    ]

    candidates: List[Dict[str, Any]] = []
    for name, interval, lim in feeds:
        try:
            candidates.extend(fetch_feed(name, interval, lim))
        except Exception as e:
            print(f"‚ùå feed fail {name}/{interval}: {e}")

    by_id: Dict[str, Dict[str, Any]] = {}
    for t in candidates:
        mid = t.get("id") or t.get("mint") or t.get("address")
        if mid:
            by_id[str(mid)] = t
    merged = list(by_id.values())
    print("   candidates_merged=", len(merged))

    out: List[Dict[str, Any]] = []
    for t in merged:
        mid = t.get("id") or t.get("mint") or t.get("address")
        if not mid:
            continue
        mid = str(mid)

        liquidity = _f(t.get("liquidity"), 0.0)
        holders = _i(t.get("holderCount"), 0)
        organic = _f(t.get("organicScore"), 0.0)

        audit = t.get("audit") or {}
        top_hold_pct = _f(audit.get("topHoldersPercentage"), 0.0)
        mint_auth_disabled = bool(audit.get("mintAuthorityDisabled"))
        freeze_auth_disabled = bool(audit.get("freezeAuthorityDisabled"))
        is_verified = bool(t.get("isVerified"))

        s1h = t.get("stats1h") or {}
        s24 = t.get("stats24h") or {}
        vol_1h = _f(s1h.get("buyVolume"), 0.0) + _f(s1h.get("sellVolume"), 0.0)
        vol_24h = _f(s24.get("buyVolume"), 0.0) + _f(s24.get("sellVolume"), 0.0)
        traders_1h = _i(s1h.get("numTraders"), 0)

        if vol_24h < MIN_VOL_24H: continue
        if vol_1h < MIN_VOL_1H: continue
        if liquidity < MIN_LIQ: continue

## 4) WHO CALLS WHO (imports + key funcs)
core/trading.py.bak_fix_dead_float_2026-01-25_150959:76:class TradingEngine:
core/trading.py.bak_fix_dead_float_2026-01-25_150959:142:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_dead_float_2026-01-25_150959:143:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_dead_float_2026-01-25_150959:163:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_normkeys3_2026-01-26_054623:12:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_normkeys3_2026-01-26_054623:75:class TokenScanner:
core/token_scanner.py.bak_normkeys3_2026-01-26_054623:120:        # ---- NORMALIZE KEYS for TradingEngine (_maybe_buy expects these) ----
core/trading.py.autofix_2026-01-25_232141.bak:2:from core.alpha_filters import should_skip_buy, score_overview
core/trading.py.autofix_2026-01-25_232141.bak:114:class TradingEngine:
core/trading.py.autofix_2026-01-25_232141.bak:180:        from core.real_executor import RealExecutor
core/trading.py.autofix_2026-01-25_232141.bak:181:        from core.paper_executor import PaperExecutor
core/trading.py.autofix_2026-01-25_232141.bak:201:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_fix_scan_2026-01-26_002838:17:from core.quality import rank_and_filter
core/token_scanner.py.bak_fix_scan_2026-01-26_002838:81:class TokenScanner:
core/token_scanner.py.bak_fix_scan_2026-01-26_002838:86:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_fix_scan_2026-01-26_002838:168:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_fix_scan_2026-01-26_002838:204:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/alpha_filters.py:49:# overviews: dict from TokenScanner
core/trading.py.bak.forcepersist.1769285101:74:class TradingEngine:
core/trading.py.bak.forcepersist.1769285101:128:        from core.real_executor import RealExecutor
core/trading.py.bak.forcepersist.1769285101:129:        from core.paper_executor import PaperExecutor
core/trading.py.bak.forcepersist.1769285101:148:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769213683:9:class TradingEngine:
core/trading.py.bak.1769213683:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769213683:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769213683:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/executor.py:21:    Les soldes sont g√©r√©s par TradingEngine (cash_paper).
core/solana_rpc_async.py:71:# 2) RiskChecker: filtres perf + anti-rug RPC (mint/freeze + block Token-2022)
core/solana_rpc_async.py:81:from core.solana_rpc_async import SolanaRpcHelper, TOKEN_PROGRAM_ID, TOKEN_2022_PROGRAM_ID
core/solana_rpc_async.py:87:class RiskChecker:
core/solana_rpc_async.py:182:# 4) Patch main.py : instancie RiskChecker(logger, rpc_url) et ferme proprement
core/solana_rpc_async.py:190:# RiskChecker() -> RiskChecker(logger=logger, rpc_url=settings.RPC_URL)
core/solana_rpc_async.py:191:s = re.sub(r"risks\s*=\s*RiskChecker\(\s*\)", "risks = RiskChecker(logger=logger, rpc_url=settings.RPC_URL)", s)
core/solana_rpc_async.py:201:print("‚úÖ OK: main.py -> RiskChecker(logger, rpc_url) + close async")
core/trading.py.bak_dexfallback_safe_2026-01-25_033933:74:class TradingEngine:
core/trading.py.bak_dexfallback_safe_2026-01-25_033933:140:        from core.real_executor import RealExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033933:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033933:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_fixindent_2026-01-25_011429:74:class TradingEngine:
core/trading.py.bak_fixindent_2026-01-25_011429:160:        from core.real_executor import RealExecutor
core/trading.py.bak_fixindent_2026-01-25_011429:161:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fixindent_2026-01-25_011429:180:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.cooldownpersist.1769284517:74:class TradingEngine:
core/trading.py.bak.cooldownpersist.1769284517:94:        from core.real_executor import RealExecutor
core/trading.py.bak.cooldownpersist.1769284517:95:        from core.paper_executor import PaperExecutor
core/trading.py.bak.cooldownpersist.1769284517:114:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_fix_conc_2026-01-26_002204:17:from core.quality import rank_and_filter
core/token_scanner.py.bak_fix_conc_2026-01-26_002204:81:class TokenScanner:
core/token_scanner.py.bak_fix_conc_2026-01-26_002204:86:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_fix_conc_2026-01-26_002204:168:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_fix_conc_2026-01-26_002204:204:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/trading.py.bak.dexfilter2.1769215856:9:class TradingEngine:
core/trading.py.bak.dexfilter2.1769215856:18:        from core.real_executor import RealExecutor
core/trading.py.bak.dexfilter2.1769215856:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.dexfilter2.1769215856:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/trading.py.bak_fix_deadmarket_2026-01-25_160351:76:class TradingEngine:
core/trading.py.bak_fix_deadmarket_2026-01-25_160351:142:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_deadmarket_2026-01-25_160351:143:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_deadmarket_2026-01-25_160351:163:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_pricefallback_2026-01-25_032624:74:class TradingEngine:
core/trading.py.bak_pricefallback_2026-01-25_032624:185:        from core.real_executor import RealExecutor
core/trading.py.bak_pricefallback_2026-01-25_032624:186:        from core.paper_executor import PaperExecutor
core/trading.py.bak_pricefallback_2026-01-25_032624:205:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/real_executor.py.bak.1769267573:16:        from core.raydium_client import RaydiumClient
core/trading.py.bak_market_quality_2026-01-25_221610:76:class TradingEngine:
core/trading.py.bak_market_quality_2026-01-25_221610:142:        from core.real_executor import RealExecutor
core/trading.py.bak_market_quality_2026-01-25_221610:143:        from core.paper_executor import PaperExecutor
core/trading.py.bak_market_quality_2026-01-25_221610:163:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.2026-01-26_144152:2:from core.alpha_filters import should_skip_buy, score_overview
core/trading.py.bak.2026-01-26_144152:113:class TradingEngine:
core/trading.py.bak.2026-01-26_144152:179:        from core.real_executor import RealExecutor
core/trading.py.bak.2026-01-26_144152:180:        from core.paper_executor import PaperExecutor
core/trading.py.bak.2026-01-26_144152:200:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769264205:131:class TradingEngine:
core/trading.py.bak.1769264205:138:        from core.real_executor import RealExecutor
core/trading.py.bak.1769264205:139:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769264205:150:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL -10%%, trailing -10%% depuis ATH).", self.mode)
core/logger.py.bak_nodup_2026-01-25_142852:42:# compat (certains de tes anciens imports faisaient "from core.logger import logger")
core/trading.py.bak_jup_refresh_2026-01-25_142852:74:class TradingEngine:
core/trading.py.bak_jup_refresh_2026-01-25_142852:140:        from core.real_executor import RealExecutor
core/trading.py.bak_jup_refresh_2026-01-25_142852:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_jup_refresh_2026-01-25_142852:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_headers_2026-01-26_001018:2:from core.quality import rank_and_filter
core/token_scanner.py.bak_headers_2026-01-26_001018:66:class TokenScanner:
core/token_scanner.py.bak_headers_2026-01-26_001018:71:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_headers_2026-01-26_001018:152:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_headers_2026-01-26_001018:188:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/real_executor.py.bak.1769213449:7:from core.solana_client import SolanaClient
core/real_executor.py.bak.1769213449:8:from core.raydium_client import RaydiumClient
core/real_executor.py.bak.1769266219:16:        from core.raydium_client import RaydiumClient
core/trading.py.corrupt.bak.1769264373:13:class TradingEngine:
core/trading.py.corrupt.bak.1769264373:24:        from core.real_executor import RealExecutor
core/trading.py.corrupt.bak.1769264373:25:        from core.paper_executor import PaperExecutor
core/trading.py.corrupt.bak.1769264373:29:        self.logger.info("[TradingEngine] Ready mode=%s", self.mode)
core/trading.py.bak_deadmarket_2026-01-25_145723:75:class TradingEngine:
core/trading.py.bak_deadmarket_2026-01-25_145723:141:        from core.real_executor import RealExecutor
core/trading.py.bak_deadmarket_2026-01-25_145723:142:        from core.paper_executor import PaperExecutor
core/trading.py.bak_deadmarket_2026-01-25_145723:162:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/logger.py.bak_nodup2_2026-01-25_143320:47:# compat (certains de tes anciens imports faisaient "from core.logger import logger")
core/trading.py.bak_fix_floatcall_2026-01-25_150355:75:class TradingEngine:
core/trading.py.bak_fix_floatcall_2026-01-25_150355:141:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_floatcall_2026-01-25_150355:142:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_floatcall_2026-01-25_150355:162:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769214793:9:class TradingEngine:
core/trading.py.bak.1769214793:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769214793:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769214793:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/trading.py.bak.bad.1769286167:74:class TradingEngine:
core/trading.py.bak.bad.1769286167:141:        from core.real_executor import RealExecutor
core/trading.py.bak.bad.1769286167:142:        from core.paper_executor import PaperExecutor
core/trading.py.bak.bad.1769286167:161:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_market_quality_2026-01-25_221610:65:class TokenScanner:
core/token_scanner.py.bak_market_quality_2026-01-25_221610:70:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_market_quality_2026-01-25_221610:151:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_market_quality_2026-01-25_221610:187:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/trading.py.bak.dexfilter.1769215685:9:class TradingEngine:
core/trading.py.bak.dexfilter.1769215685:18:        from core.real_executor import RealExecutor
core/trading.py.bak.dexfilter.1769215685:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.dexfilter.1769215685:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/logger.py.bak:42:# compat (certains de tes anciens imports faisaient "from core.logger import logger")
core/trading.py.bak_tp_2026-01-24_224956:74:class TradingEngine:
core/trading.py.bak_tp_2026-01-24_224956:140:        from core.real_executor import RealExecutor
core/trading.py.bak_tp_2026-01-24_224956:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_tp_2026-01-24_224956:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/real_executor.py.bak.1769201424:7:from core.executor import Executor, Fill
core/real_executor.py.bak.1769201424:10:    from core.raydium_client import RaydiumClient
core/real_executor.py.bak.1769201424:44:            from core.solana_client import SolanaClient  # si existe dans ton repo
core/token_scanner.py.bak_rewrite_2026-01-26_034617:185:    Convertit une pair DexScreener -> format "overview" compatible TradingEngine.
core/token_scanner.py.bak_rewrite_2026-01-26_034617:230:class TokenScanner:
core/token_scanner.py.bak_rewrite_2026-01-26_034617:299:                    print(f"[TokenScanner] search error q={q}: {e}")
core/trading.py.bak_fix_jup_pricev3_2026-01-25_133921:74:class TradingEngine:
core/trading.py.bak_fix_jup_pricev3_2026-01-25_133921:140:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_jup_pricev3_2026-01-25_133921:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_jup_pricev3_2026-01-25_133921:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_fix_empty_except_2026-01-25_144223:74:class TradingEngine:
core/trading.py.bak_fix_empty_except_2026-01-25_144223:140:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_empty_except_2026-01-25_144223:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_empty_except_2026-01-25_144223:161:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_fixindent_2026-01-25_011447:74:class TradingEngine:
core/trading.py.bak_fixindent_2026-01-25_011447:160:        from core.real_executor import RealExecutor
core/trading.py.bak_fixindent_2026-01-25_011447:161:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fixindent_2026-01-25_011447:180:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769268091:24:class TradingEngine:
core/trading.py.bak.1769268091:43:        from core.real_executor import RealExecutor
core/trading.py.bak.1769268091:44:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769268091:63:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769210210:9:class TradingEngine:
core/trading.py.bak.1769210210:17:        from core.real_executor import RealExecutor
core/trading.py.bak.1769210210:18:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769210210:26:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/trading.py.bak_price_log_2026-01-25_142108:74:class TradingEngine:
core/trading.py.bak_price_log_2026-01-25_142108:140:        from core.real_executor import RealExecutor
core/trading.py.bak_price_log_2026-01-25_142108:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_price_log_2026-01-25_142108:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.persistcooldown.1769284223:74:class TradingEngine:
core/trading.py.bak.persistcooldown.1769284223:94:        from core.real_executor import RealExecutor
core/trading.py.bak.persistcooldown.1769284223:95:        from core.paper_executor import PaperExecutor
core/trading.py.bak.persistcooldown.1769284223:114:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak:10:from config.settings import (
core/trading.py.bak:21:    from core.raydium_client import RaydiumClient
core/trading.py.bak:111:class TradingEngine:
core/trading.py.bak:114:      TradingEngine(wallet, logger, positions_file=..., mode=...)
core/trading.py.bak:145:        self.logger.info("[TradingEngine] Initialis√© (Moonshot trailing only).")
core/trading.py.bak:150:            self.logger.info(f"[TradingEngine] 0 positions recharg√©es (fichier absent).")
core/trading.py.bak:176:            self.logger.info(f"[TradingEngine] {len(self.positions)} positions recharg√©es depuis {self.positions_file}.")
core/trading.py.bak:178:            self.logger.warning(f"[TradingEngine] load positions error: {e}")
core/trading.py.bak:190:            self.logger.warning(f"[TradingEngine] save positions error: {e}")
core/trading.py.bak.1769210350:9:class TradingEngine:
core/trading.py.bak.1769210350:17:        from core.real_executor import RealExecutor
core/trading.py.bak.1769210350:18:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769210350:26:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/token_scanner.py.bak_dexfallback_2026-01-26_003537:17:from core.quality import rank_and_filter
core/token_scanner.py.bak_dexfallback_2026-01-26_003537:81:class TokenScanner:
core/token_scanner.py.bak_dexfallback_2026-01-26_003537:86:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_dexfallback_2026-01-26_003537:168:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_dexfallback_2026-01-26_003537:204:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/real_executor.py.bak.1769267779:16:        from core.raydium_client import RaydiumClient
core/real_executor.py.bak_2026-01-24_224925:16:        from core.raydium_client import RaydiumClient
core/trading.py:2:from core.alpha_filters import should_skip_buy, score_overview
core/trading.py:113:class TradingEngine:
core/trading.py:179:        from core.real_executor import RealExecutor
core/trading.py:180:        from core.paper_executor import PaperExecutor
core/trading.py:200:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/real_executor.py.bak.1769262998:16:        from core.raydium_client import RaydiumClient
core/token_scanner.py.bak_force_data_2026-01-26_041022:16:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_force_data_2026-01-26_041022:99:class TokenScanner:
core/token_scanner.py.bak_force_data_2026-01-26_041022:165:                    logger.warning(f"[TokenScanner] DexScreener HTTP {resp.status} for q={q} body={txt[:200]}")
core/token_scanner.py.bak_force_data_2026-01-26_041022:185:                    logger.exception(f"[TokenScanner] dex_search error q={q}: {e}")
core/trading.py.bak.fixkeys.1769208985:9:class TradingEngine:
core/trading.py.bak.fixkeys.1769208985:18:        from core.real_executor import RealExecutor
core/trading.py.bak.fixkeys.1769208985:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.fixkeys.1769208985:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/token_scanner.py.bak.1768937148:11:from core.birdeye_async import BirdeyeAsyncClient
core/token_scanner.py.bak.1768937148:25:class TokenScanner:
core/token_scanner.py.bak.1768937148:223:                print(f"[TokenScanner] Jupiter 429 -> backoff {int(self._backoff)}s")
core/token_scanner.py.bak.1768937148:229:                print(f"[TokenScanner] Birdeye rate-limit -> backoff {int(self._backoff)}s")
core/token_scanner.py.bak.1768937148:232:            print(f"[TokenScanner] scan error: {e}")
core/real_executor.py.bak.1769263883:16:        from core.raydium_client import RaydiumClient
core/trading.py.bak_price_dedup_2026-01-25_143635:74:class TradingEngine:
core/trading.py.bak_price_dedup_2026-01-25_143635:140:        from core.real_executor import RealExecutor
core/trading.py.bak_price_dedup_2026-01-25_143635:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_price_dedup_2026-01-25_143635:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_rm_price_dups_2026-01-25_143940:74:class TradingEngine:
core/trading.py.bak_rm_price_dups_2026-01-25_143940:140:        from core.real_executor import RealExecutor
core/trading.py.bak_rm_price_dups_2026-01-25_143940:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_rm_price_dups_2026-01-25_143940:161:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_dexfallback_safe_2026-01-25_033402:74:class TradingEngine:
core/trading.py.bak_dexfallback_safe_2026-01-25_033402:140:        from core.real_executor import RealExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033402:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033402:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_cleanup_norm_2026-01-26_055013:12:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_cleanup_norm_2026-01-26_055013:75:class TokenScanner:
core/token_scanner.py.bak_cleanup_norm_2026-01-26_055013:120:        # ---- NORMALIZE KEYS for TradingEngine (_maybe_buy expects these) ----
core/token_scanner.py.bak_cleanup_norm_2026-01-26_055013:155:        # TradingEngine._maybe_buy attend: dex_id, price_usd, price, liquidity_usd, marketcap_usd
core/trading.py.bak.1769262979:26:class TradingEngine:
core/trading.py.bak.1769262979:39:        from core.real_executor import RealExecutor
core/trading.py.bak.1769262979:40:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769262979:47:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/risk_checks.py:11:from core.anti_rug import AntiRug
core/risk_checks.py:12:from core.dev_profiler import DevProfiler
core/risk_checks.py:17:    from core.solana_rpc_async import SolanaRPCAsync  # type: ignore
core/risk_checks.py:35:class RiskChecker:
core/risk_checks.py:41:      - AntiRug on-chain (mint/freeze renounced + Token-2022 block + top holders)
core/risk_checks.py:63:            self.anti = AntiRug(self.rpc, self.logger, block_token_2022=bool(getattr(settings, "RISK_BLOCK_TOKEN_2022", True)))
core/trading.py.bak.fixsellts.1769283675:74:class TradingEngine:
core/trading.py.bak.fixsellts.1769283675:94:        from core.real_executor import RealExecutor
core/trading.py.bak.fixsellts.1769283675:95:        from core.paper_executor import PaperExecutor
core/trading.py.bak.fixsellts.1769283675:114:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_2026-01-26_044833:13:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_2026-01-26_044833:80:class TokenScanner:
core/token_scanner.py.bak_2026-01-26_044833:82:    TokenScanner bas√© sur DexScreener search.
core/token_scanner.py.bak_2026-01-26_044833:83:    IMPORTANT compat TradingEngine:
core/token_scanner.py.bak_2026-01-26_044833:84:      - TradingEngine lit ov['data'] (raw DexScreener pair)
core/token_scanner.py.bak_2026-01-26_044833:258:                # *** LE POINT CRITIQUE : compat TradingEngine ***
core/token_scanner.py.bak_2026-01-26_044833:265:            logger.exception("[TokenScanner] pair_to_overview error: %s", e)
core/trading.py.bak.1769213990:9:class TradingEngine:
core/trading.py.bak.1769213990:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769213990:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769213990:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/logger.py:47:# compat (certains de tes anciens imports faisaient "from core.logger import logger")
core/candidate_pipeline.py:4:from core.dev_profiler import DevProfiler
core/trading.py.bak_2026-01-25_011048:74:class TradingEngine:
core/trading.py.bak_2026-01-25_011048:140:        from core.real_executor import RealExecutor
core/trading.py.bak_2026-01-25_011048:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_2026-01-25_011048:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_fix_missing_2026-01-26_014513:48:    from core.logger import get_logger  # type: ignore
core/token_scanner.py.bak_fix_missing_2026-01-26_014513:135:# TokenScanner (DexScreener)
core/token_scanner.py.bak_fix_missing_2026-01-26_014513:137:class TokenScanner:
core/trading.py.bak_fix_time_2026-01-25_230918:2:from core.alpha_filters import should_skip_buy, score_overview
core/trading.py.bak_fix_time_2026-01-25_230918:115:class TradingEngine:
core/trading.py.bak_fix_time_2026-01-25_230918:181:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_time_2026-01-25_230918:182:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_time_2026-01-25_230918:202:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/real_executor.py.bak.1769213700:7:from core.solana_client import SolanaClient
core/real_executor.py.bak.1769213700:8:from core.raydium_client import RaydiumClient
core/trading.py.bak.1769280726:24:class TradingEngine:
core/trading.py.bak.1769280726:43:        from core.real_executor import RealExecutor
core/trading.py.bak.1769280726:44:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769280726:63:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769207330:9:class TradingEngine:
core/trading.py.bak.1769207330:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769207330:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769207330:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/trading.py.BROKEN:13:    from core.real_executor import RealExecutor
core/trading.py.BROKEN:117:class TradingEngine:
core/trading.py.BROKEN:119:    TradingEngine:
core/trading.py.BROKEN:148:                self.logger.warning("[TradingEngine] RealExecutor introuvable -> REAL en mode log-only.")
core/trading.py.BROKEN:154:        self.logger.info("[TradingEngine] Initialis√© (PAPER/REAL executor, SL + trailing activ√©).")
core/trading.py.BROKEN:159:            self.logger.info("[TradingEngine] 0 positions recharg√©es (fichier absent).")
core/trading.py.BROKEN:183:            self.logger.info(f"[TradingEngine] positions ouvertes={len(self.positions)} ferm√©es={len(self.closed_trades)} recharg√©es.")
core/trading.py.BROKEN:185:            self.logger.warning(f"[TradingEngine] load positions error: {e}")
core/trading.py.BROKEN:197:            self.logger.warning(f"[TradingEngine] save positions error: {e}")
core/token_scanner.py.bak.raydiumonly.1769216158:40:class TokenScanner:
core/token_scanner.py.bak.raydiumonly.1769216158:45:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak.raydiumonly.1769216158:126:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_normkeys2_2026-01-26_053953:12:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_normkeys2_2026-01-26_053953:75:class TokenScanner:
core/token_scanner.py.bak_normkeys2_2026-01-26_053953:120:        # ---- NORMALIZE KEYS for TradingEngine (_maybe_buy expects these) ----
core/trading.py.bak_fix_continue_2026-01-25_013243:74:class TradingEngine:
core/trading.py.bak_fix_continue_2026-01-25_013243:155:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_continue_2026-01-25_013243:156:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_continue_2026-01-25_013243:175:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/risk_checks.py.bak.1769201424:4:from config.settings import MIN_LIQUIDITY_USD, MAX_MARKET_CAP_USD
core/risk_checks.py.bak.1769201424:7:class RiskChecker:
core/token_scanner.py.bak_fix_missing_2026-01-26_014522:56:    from core.logger import get_logger  # type: ignore
core/token_scanner.py.bak_fix_missing_2026-01-26_014522:143:# TokenScanner (DexScreener)
core/token_scanner.py.bak_fix_missing_2026-01-26_014522:145:class TokenScanner:
core/trading.py.bak_fix_float_now_2026-01-25_213504:76:class TradingEngine:
core/trading.py.bak_fix_float_now_2026-01-25_213504:142:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_float_now_2026-01-25_213504:143:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_float_now_2026-01-25_213504:163:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.strategy.1769261647:9:class TradingEngine:
core/trading.py.bak.strategy.1769261647:18:        from core.real_executor import RealExecutor
core/trading.py.bak.strategy.1769261647:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.strategy.1769261647:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/trading.py.bak.1769213824:9:class TradingEngine:
core/trading.py.bak.1769213824:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769213824:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769213824:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/trading.py.bak_patch_dexprice_2026-01-25_032954:74:class TradingEngine:
core/trading.py.bak_patch_dexprice_2026-01-25_032954:140:        from core.real_executor import RealExecutor
core/trading.py.bak_patch_dexprice_2026-01-25_032954:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_patch_dexprice_2026-01-25_032954:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/anti_rug.py:16:class AntiRugResult:
core/anti_rug.py:21:class AntiRug:
core/anti_rug.py:93:    async def check(self, mint: str, *, max_top1: float, max_top10: float, require_renounced: bool) -> AntiRugResult:
core/anti_rug.py:100:            return AntiRugResult(False, "mint introuvable (RPC)", details)
core/anti_rug.py:103:            return AntiRugResult(False, "Token-2022 bloqu√© (risque fees/extensions)", details)
core/anti_rug.py:106:            return AntiRugResult(False, f"programme token inconnu: {owner}", details)
core/anti_rug.py:114:                return AntiRugResult(False, "mint authority active (remint possible)", details)
core/anti_rug.py:116:                return AntiRugResult(False, "freeze authority active (gel possible)", details)
core/anti_rug.py:123:                return AntiRugResult(False, f"top1 trop concentr√© ({top1:.1%})", details)
core/anti_rug.py:125:                return AntiRugResult(False, f"top10 trop concentr√© ({top10:.1%})", details)
core/anti_rug.py:128:            return AntiRugResult(False, f"holders check fail: {e}", details)
core/anti_rug.py:130:        return AntiRugResult(True, "ok", details)
core/trading.py.bak_alpha_2026-01-25_223115:114:class TradingEngine:
core/trading.py.bak_alpha_2026-01-25_223115:180:        from core.real_executor import RealExecutor
core/trading.py.bak_alpha_2026-01-25_223115:181:        from core.paper_executor import PaperExecutor
core/trading.py.bak_alpha_2026-01-25_223115:201:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak.filternone.1769216165:40:class TokenScanner:
core/token_scanner.py.bak.filternone.1769216165:45:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak.filternone.1769216165:126:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_norm_keys_2026-01-26_052828:12:logger = logging.getLogger("TokenScanner")
core/token_scanner.py.bak_norm_keys_2026-01-26_052828:75:class TokenScanner:
core/trading.py.bak_dexfallback_safe_2026-01-25_033354:74:class TradingEngine:
core/trading.py.bak_dexfallback_safe_2026-01-25_033354:140:        from core.real_executor import RealExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033354:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_dexfallback_safe_2026-01-25_033354:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_full_2026-01-26_010911:17:from core.quality import rank_and_filter
core/token_scanner.py.bak_full_2026-01-26_010911:81:class TokenScanner:
core/token_scanner.py.bak_full_2026-01-26_010911:86:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_full_2026-01-26_010911:168:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_full_2026-01-26_010911:204:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/trading.py.bak_fix_builtins_safe_float_2026-01-25_170020:76:class TradingEngine:
core/trading.py.bak_fix_builtins_safe_float_2026-01-25_170020:142:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_builtins_safe_float_2026-01-25_170020:143:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_builtins_safe_float_2026-01-25_170020:163:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_fix_scannerconfig_2026-01-26_011950:13:    from core.logger import get_logger  # type: ignore
core/token_scanner.py.bak_fix_scannerconfig_2026-01-26_011950:101:# TokenScanner (DexScreener)
core/token_scanner.py.bak_fix_scannerconfig_2026-01-26_011950:103:class TokenScanner:
core/trading.py.bak_add_sellcooldown_2026-01-25_012259:74:class TradingEngine:
core/trading.py.bak_add_sellcooldown_2026-01-25_012259:155:        from core.real_executor import RealExecutor
core/trading.py.bak_add_sellcooldown_2026-01-25_012259:156:        from core.paper_executor import PaperExecutor
core/trading.py.bak_add_sellcooldown_2026-01-25_012259:175:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/token_scanner.py.bak_dns_failsoft_2026-01-25_160351:65:class TokenScanner:
core/token_scanner.py.bak_dns_failsoft_2026-01-25_160351:70:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_dns_failsoft_2026-01-25_160351:151:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak.1769280726:40:class TokenScanner:
core/token_scanner.py.bak.1769280726:45:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak.1769280726:126:        # Apply filters here (so TradingEngine receives only candidates)
core/trading.py.bak.1769265095:12:class TradingEngine:
core/trading.py.bak.1769265095:35:        from core.real_executor import RealExecutor
core/trading.py.bak.1769265095:36:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769265095:43:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL=-10%%, trailing=-10%% du high).", self.mode)
core/wallet.py.bak.1769255197:12:from config.settings import RPC_URL
core/logger.py.bak_logger_patch_2026-01-25_143635:47:# compat (certains de tes anciens imports faisaient "from core.logger import logger")
core/trading.py.bak_before_nowfix_2026-01-25_234653:2:from core.alpha_filters import should_skip_buy, score_overview
core/trading.py.bak_before_nowfix_2026-01-25_234653:115:class TradingEngine:
core/trading.py.bak_before_nowfix_2026-01-25_234653:181:        from core.real_executor import RealExecutor
core/trading.py.bak_before_nowfix_2026-01-25_234653:182:        from core.paper_executor import PaperExecutor
core/trading.py.bak_before_nowfix_2026-01-25_234653:202:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.fix.1769207647:9:class TradingEngine:
core/trading.py.bak.fix.1769207647:18:        from core.real_executor import RealExecutor
core/trading.py.bak.fix.1769207647:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.fix.1769207647:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."
core/trading.py.bak.dexfilter3.1769215965:9:class TradingEngine:
core/trading.py.bak.dexfilter3.1769215965:18:        from core.real_executor import RealExecutor
core/trading.py.bak.dexfilter3.1769215965:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.dexfilter3.1769215965:26:        self.logger.info("[TradingEngine] Initialis√© (mode=%s, SL + trailing activ√©).", self.mode)
core/wallet_manager.py:6:from config.settings import WALLETS, DEFAULT_MAX_POSITIONS_PER_WALLET
core/trading.py.bak_fix_requests_2026-01-25_131226:74:class TradingEngine:
core/trading.py.bak_fix_requests_2026-01-25_131226:140:        from core.real_executor import RealExecutor
core/trading.py.bak_fix_requests_2026-01-25_131226:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_fix_requests_2026-01-25_131226:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_jup_stale_fallback_2026-01-25_144608:74:class TradingEngine:
core/trading.py.bak_jup_stale_fallback_2026-01-25_144608:140:        from core.real_executor import RealExecutor
core/trading.py.bak_jup_stale_fallback_2026-01-25_144608:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_jup_stale_fallback_2026-01-25_144608:161:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/pumpfun_tracker.py:8:from core.pumpfun_mint_resolver import MintResolver
core/trading.py.bak.1769265571:33:class TradingEngine:
core/trading.py.bak.1769265571:58:        from core.real_executor import RealExecutor
core/trading.py.bak.1769265571:59:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769265571:72:            "[TradingEngine] Initialis√© (mode=%s, SL=-%.0f%%, trailing=-%.0f%% du high).",
core/token_scanner.py.bak_fix_cfg_2026-01-26_001257:8:from core.quality import rank_and_filter
core/token_scanner.py.bak_fix_cfg_2026-01-26_001257:72:class TokenScanner:
core/token_scanner.py.bak_fix_cfg_2026-01-26_001257:77:    On retourne une liste d'overviews (dict) compatibles avec ton TradingEngine.
core/token_scanner.py.bak_fix_cfg_2026-01-26_001257:159:        # Apply filters here (so TradingEngine receives only candidates)
core/token_scanner.py.bak_fix_cfg_2026-01-26_001257:195:                self.logger.warning('[TokenScanner] dexscreener error (fail-soft): %s', e)
core/trading.py.bak_rm_bad_import_2026-01-25_131647:74:class TradingEngine:
core/trading.py.bak_rm_bad_import_2026-01-25_131647:140:        from core.real_executor import RealExecutor
core/trading.py.bak_rm_bad_import_2026-01-25_131647:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_rm_bad_import_2026-01-25_131647:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak_dexpatch_ok_2026-01-25_035540:74:class TradingEngine:
core/trading.py.bak_dexpatch_ok_2026-01-25_035540:140:        from core.real_executor import RealExecutor
core/trading.py.bak_dexpatch_ok_2026-01-25_035540:141:        from core.paper_executor import PaperExecutor
core/trading.py.bak_dexpatch_ok_2026-01-25_035540:160:            "[TradingEngine] Initialis√© (mode=%s, SL=%s%%, trailing=%s%% du high). positions_file=%s",
core/trading.py.bak.1769207465:9:class TradingEngine:
core/trading.py.bak.1769207465:18:        from core.real_executor import RealExecutor
core/trading.py.bak.1769207465:19:        from core.paper_executor import PaperExecutor
core/trading.py.bak.1769207465:27:            f"[TradingEngine] Initialis√© (mode={mode}, SL + trailing activ√©)."

## 5) RISK / ANTI-RUG / DEV-PROFILER wiring
core/trading.py.bak_fix_dead_float_2026-01-25_150959:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.autofix_2026-01-25_232141.bak:687:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.forcepersist.1769285101:411:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769213683:63:            ok, reason = risk_checker.allow_buy(ov)
core/solana_client.py:57:        TOKEN_2022_PROGRAM = "TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"
core/solana_client.py:140:        r2 = await _fetch_for_program(TOKEN_2022_PROGRAM)
core/solana_rpc_async.py:10:TOKEN_2022_PROGRAM_ID = "TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"
core/solana_rpc_async.py:71:# 2) RiskChecker: filtres perf + anti-rug RPC (mint/freeze + block Token-2022)
core/solana_rpc_async.py:81:from core.solana_rpc_async import SolanaRpcHelper, TOKEN_PROGRAM_ID, TOKEN_2022_PROGRAM_ID
core/solana_rpc_async.py:87:class RiskChecker:
core/solana_rpc_async.py:104:        self.block_token_2022 = os.getenv("BLOCK_TOKEN_2022", "1").strip() != "0"
core/solana_rpc_async.py:109:    async def allow_buy(self, ov: Dict[str, Any]) -> Tuple[bool, str]:
core/solana_rpc_async.py:141:        if self.block_token_2022 and auth.owner_program == TOKEN_2022_PROGRAM_ID:
core/solana_rpc_async.py:147:        if auth.owner_program not in (TOKEN_PROGRAM_ID, TOKEN_2022_PROGRAM_ID):
core/solana_rpc_async.py:152:        # mint/freeze authority present => gros red flags
core/solana_rpc_async.py:154:            res = (False, "mint authority active (risque mint infini)")
core/solana_rpc_async.py:158:            res = (False, "freeze authority active (risque freeze wallet)")
core/solana_rpc_async.py:167:# 3) Patch trading.py : s'assure qu'on await bien risk_checker.allow_buy(ov)
core/solana_rpc_async.py:175:s = s.replace("ok_risk, why_risk = risk_checker.allow_buy(ov)", "ok_risk, why_risk = await risk_checker.allow_buy(ov)")
core/solana_rpc_async.py:176:s = s.replace("ok_risk, why_risk = await risk_checker.allow_buy_async(ov)", "ok_risk, why_risk = await risk_checker.allow_buy(ov)")
core/solana_rpc_async.py:179:print("‚úÖ OK: trading.py -> risk_checker.allow_buy() est await")
core/solana_rpc_async.py:182:# 4) Patch main.py : instancie RiskChecker(logger, rpc_url) et ferme proprement
core/solana_rpc_async.py:190:# RiskChecker() -> RiskChecker(logger=logger, rpc_url=settings.RPC_URL)
core/solana_rpc_async.py:191:s = re.sub(r"risks\s*=\s*RiskChecker\(\s*\)", "risks = RiskChecker(logger=logger, rpc_url=settings.RPC_URL)", s)
core/solana_rpc_async.py:201:print("‚úÖ OK: main.py -> RiskChecker(logger, rpc_url) + close async")
core/solana_rpc_async.py:226:BLOCK_TOKEN_2022="1" && \
core/trading.py.bak_dexfallback_safe_2026-01-25_033933:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fixindent_2026-01-25_011429:454:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.cooldownpersist.1769284517:376:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.dexfilter2.1769215856:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_deadmarket_2026-01-25_160351:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_pricefallback_2026-01-25_032624:507:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_market_quality_2026-01-25_221610:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.2026-01-26_144152:686:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769264205:288:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_jup_refresh_2026-01-25_142852:509:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.corrupt.bak.1769264373:114:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_deadmarket_2026-01-25_145723:577:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_floatcall_2026-01-25_150355:641:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769214793:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.bad.1769286167:424:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.dexfilter.1769215685:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_tp_2026-01-24_224956:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_jup_pricev3_2026-01-25_133921:474:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_empty_except_2026-01-25_144223:553:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fixindent_2026-01-25_011447:454:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769268091:296:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769210210:60:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_price_log_2026-01-25_142108:499:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.persistcooldown.1769284223:376:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak:313:            ok_risk, why_risk = risk_checker.allow_buy(ov)
core/trading.py.bak.1769210350:60:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py:712:            ok, reason = await risk_checker.allow_buy(ov)
core/trading.py.bak.fixkeys.1769208985:50:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_price_dedup_2026-01-25_143635:515:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_rm_price_dups_2026-01-25_143940:555:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_dexfallback_safe_2026-01-25_033402:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769262979:271:            ok, reason = risk_checker.allow_buy(ov)
core/risk_checks.py:11:from core.anti_rug import AntiRug
core/risk_checks.py:12:from core.dev_profiler import DevProfiler
core/risk_checks.py:22:BLACKLIST_DEV_PATH = Path(os.getenv("BLACKLIST_DEV_PATH", "state/blacklist_dev.json"))
core/risk_checks.py:23:BLACKLIST_MINT_PATH = Path(os.getenv("BLACKLIST_MINT_PATH", "state/blacklist_mint.json"))
core/risk_checks.py:35:class RiskChecker:
core/risk_checks.py:40:      - DevProfiler (si creator pr√©sent)
core/risk_checks.py:41:      - AntiRug on-chain (mint/freeze renounced + Token-2022 block + top holders)
core/risk_checks.py:49:        self.dev_profiler = DevProfiler(path=os.getenv("DEV_DB_PATH", "dev_db.json"))
core/risk_checks.py:63:            self.anti = AntiRug(self.rpc, self.logger, block_token_2022=bool(getattr(settings, "RISK_BLOCK_TOKEN_2022", True)))
core/risk_checks.py:89:    def _is_mint_blacklisted(self, mint: str) -> Tuple[bool, str]:
core/risk_checks.py:98:    def _is_dev_blacklisted(self, dev: str) -> Tuple[bool, str]:
core/risk_checks.py:104:    async def allow_buy(self, ov: Dict[str, Any]) -> Tuple[bool, str]:
core/risk_checks.py:136:        # -------- 1) blacklists --------
core/risk_checks.py:137:        is_bl_m, why_m = self._is_mint_blacklisted(mint)
core/risk_checks.py:139:            return False, f"mint blacklisted: {why_m}"
core/risk_checks.py:142:            is_bl_d, why_d = self._is_dev_blacklisted(creator)
core/risk_checks.py:144:                return False, f"dev blacklisted: {why_d}"
core/risk_checks.py:154:                return False, "anti_rug unavailable (no rpc client)"
core/risk_checks.py:155:            return True, "ok(paper_no_anti_rug)"
core/risk_checks.py:176:                self._cache[mint] = (now, False, f"anti_rug_exc: {e}")
core/risk_checks.py:177:                return False, f"anti_rug_exc: {e}"
core/risk_checks.py:178:            return True, f"ok(paper_anti_rug_exc:{e})"
core/trading.py.bak.fixsellts.1769283675:377:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769213990:61:            ok, reason = risk_checker.allow_buy(ov)
core/candidate_pipeline.py:4:from core.dev_profiler import DevProfiler
core/candidate_pipeline.py:13:        self.dev_profiler = DevProfiler()
core/trading.py.bak_2026-01-25_011048:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_time_2026-01-25_230918:688:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769280726:296:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769207330:50:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.BROKEN:313:            ok_risk, why_risk = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_continue_2026-01-25_013243:456:            ok, reason = risk_checker.allow_buy(ov)
core/risk_checks.py.bak.1769201424:7:class RiskChecker:
core/risk_checks.py.bak.1769201424:13:    def allow_buy(self, ov: Dict[str, Any]) -> Tuple[bool, str]:
core/trading.py.bak_fix_float_now_2026-01-25_213504:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.strategy.1769261647:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769213824:63:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_patch_dexprice_2026-01-25_032954:433:            ok, reason = risk_checker.allow_buy(ov)
core/anti_rug.py:10:TOKEN_2022_PROGRAM_ID = "TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"
core/anti_rug.py:16:class AntiRugResult:
core/anti_rug.py:21:class AntiRug:
core/anti_rug.py:24:    - mint authority / freeze authority must be None (renounced)
core/anti_rug.py:26:    - top holders concentration via getTokenLargestAccounts
core/anti_rug.py:35:        # getAccountInfo gives owner program id
core/anti_rug.py:93:    async def check(self, mint: str, *, max_top1: float, max_top10: float, require_renounced: bool) -> AntiRugResult:
core/anti_rug.py:100:            return AntiRugResult(False, "mint introuvable (RPC)", details)
core/anti_rug.py:102:        if self.block_token_2022 and owner == TOKEN_2022_PROGRAM_ID:
core/anti_rug.py:103:            return AntiRugResult(False, "Token-2022 bloqu√© (risque fees/extensions)", details)
core/anti_rug.py:105:        if owner not in (TOKEN_PROGRAM_ID, TOKEN_2022_PROGRAM_ID):
core/anti_rug.py:106:            return AntiRugResult(False, f"programme token inconnu: {owner}", details)
core/anti_rug.py:114:                return AntiRugResult(False, "mint authority active (remint possible)", details)
core/anti_rug.py:116:                return AntiRugResult(False, "freeze authority active (gel possible)", details)
core/anti_rug.py:123:                return AntiRugResult(False, f"top1 trop concentr√© ({top1:.1%})", details)
core/anti_rug.py:125:                return AntiRugResult(False, f"top10 trop concentr√© ({top10:.1%})", details)
core/anti_rug.py:128:            return AntiRugResult(False, f"holders check fail: {e}", details)
core/anti_rug.py:130:        return AntiRugResult(True, "ok", details)
core/trading.py.bak_alpha_2026-01-25_223115:680:            ok, reason = risk_checker.allow_buy(ov)
core/dev_profiler.py:7:class DevProfiler:
core/dev_profiler.py:38:                "blacklisted": False,
core/dev_profiler.py:55:            p["blacklisted"] = True
core/dev_profiler.py:61:        if p.get("blacklisted"):
core/trading.py.bak_dexfallback_safe_2026-01-25_033354:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_builtins_safe_float_2026-01-25_170020:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_add_sellcooldown_2026-01-25_012259:449:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769265095:179:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_before_nowfix_2026-01-25_234653:688:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.fix.1769207647:50:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.dexfilter3.1769215965:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_requests_2026-01-25_131226:475:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_jup_stale_fallback_2026-01-25_144608:554:            ok, reason = risk_checker.allow_buy(ov)
core/pumpfun_tracker.py:19:      - BAN_DEV       : dev blacklist√© (plus tard)
core/trading.py.bak.1769265571:208:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_rm_bad_import_2026-01-25_131647:475:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_dexpatch_ok_2026-01-25_035540:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769207465:50:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_patch_dexprice_2026-01-25_032945:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_rm_badblock_2026-01-25_011842:454:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.fixcooldownorder.1769285244:414:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_2026-01-25_230047:688:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_final_fix_2026-01-25_235357:688:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_price_log_2026-01-25_142015:489:            ok, reason = risk_checker.allow_buy(ov)
core/risk_checks.py.bak:9:class RiskChecker:
core/risk_checks.py.bak:12:    def allow_buy(self, ov: Dict[str, Any]) -> Tuple[bool, str]:
core/trading.py.bak_force_rm_requests_2026-01-25_132205:475:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix_jup_parsev3_2026-01-25_134330:474:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_fix__safe_builtins_2026-01-25_152702:642:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_before_dexpatch_2026-01-25_034254:433:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769263883:288:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.cooldown.1769283173:375:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak.1769214803:61:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_pricefallback_2026-01-25_032551:456:            ok, reason = risk_checker.allow_buy(ov)
core/trading.py.bak_2026-01-24_222418:424:            ok, reason = risk_checker.allow_buy(ov)
src/main.py.bak.fixloop2.1769208657:16:from core.risk_checks import RiskChecker
src/main.py.bak.fixloop2.1769208657:52:    risks = RiskChecker()
src/main.py.bak_api_fix_2026-01-25_023024:23:from core.risk_checks import RiskChecker
src/main.py.bak_api_fix_2026-01-25_023024:58:    risks = RiskChecker()
src/rpc_client.py:40:        res = await self.call(session, "getAccountInfo", [pubkey, {"encoding": encoding}])
src/rpc_client.py:44:        res = await self.call(session, "getTokenLargestAccounts", [mint])
src/main.py.bak_fix_new_listing_2026-01-26_020409:23:from core.risk_checks import RiskChecker
src/main.py.bak_fix_new_listing_2026-01-26_020409:58:    risks = RiskChecker()
src/main.py:23:from core.risk_checks import RiskChecker
src/main.py:58:    risks = RiskChecker(logger=logger, rpc_url=settings.RPC_URL, mode=settings.MODE)
src/main.py.bak_indentfix:16:from core.risk_checks import RiskChecker
src/main.py.bak_indentfix:52:    risks = RiskChecker()
src/main.py.bak_env_2026-01-25_020937:16:from core.risk_checks import RiskChecker
src/main.py.bak_env_2026-01-25_020937:51:    risks = RiskChecker()
src/risk_engine.py:10:# Files: blacklist dev / mint
src/risk_engine.py:38:BLACKLIST_DEV_PATH = Path("state/blacklist_dev.json")
src/risk_engine.py:39:BLACKLIST_MINT_PATH = Path("state/blacklist_mint.json")
src/risk_engine.py:56:def _load_blacklist_dev() -> Dict[str, str]:
src/risk_engine.py:60:def blacklist_dev(dev: str, reason: str):
src/risk_engine.py:64:    bl = _load_blacklist_dev()
src/risk_engine.py:70:def is_dev_blacklisted(dev: str) -> bool:
src/risk_engine.py:74:    return dev in _load_blacklist_dev()
src/risk_engine.py:77:def _load_blacklist_mint() -> Dict[str, Dict[str, Any]]:
src/risk_engine.py:82:def blacklist_mint(mint: str, reason: str, ttl_sec: int = 900):
src/risk_engine.py:86:    bl = _load_blacklist_mint()
src/risk_engine.py:92:def is_mint_blacklisted(mint: str) -> bool:
src/risk_engine.py:96:    bl = _load_blacklist_mint()
src/risk_engine.py:153:    if is_mint_blacklisted(mint):
src/risk_engine.py:154:        bl = _load_blacklist_mint().get(mint, {})
src/risk_engine.py:155:        return (False, 0, ["MINT_BLACKLISTED"], {"blacklist": bl})
src/risk_engine.py:196:    # DEV blacklist
src/risk_engine.py:197:    if dev and is_dev_blacklisted(dev):
src/main.py.bak.fixloop.1769208543:16:from core.risk_checks import RiskChecker
src/main.py.bak.fixloop.1769208543:52:    risks = RiskChecker()
src/main.py.bak_noblock_api_2026-01-25_022602:23:from core.risk_checks import RiskChecker
src/main.py.bak_noblock_api_2026-01-25_022602:58:    risks = RiskChecker()
src/main.py.bak_fixindent_api_2026-01-25_023422:23:from core.risk_checks import RiskChecker
src/main.py.bak_fixindent_api_2026-01-25_023422:58:    risks = RiskChecker()
src/main.py.bak_indentfix2:16:from core.risk_checks import RiskChecker
src/main.py.bak_indentfix2:52:    risks = RiskChecker()
src/main.py.bak:17:from core.risk_checks import RiskChecker
src/main.py.bak:43:    risks = RiskChecker(logger=logger)
src/main.py.bak.fix.1769207974:16:from core.risk_checks import RiskChecker
src/main.py.bak.fix.1769207974:52:    risks = RiskChecker()

## 6) CONFIG sanity (config/ + src/config*)
total 128
drwxr-xr-x 3 tng25 tng25 4096 Jan 28 01:08 .
drwxr-xr-x 7 tng25 tng25 4096 Jan 28 00:33 ..
-rw-r--r-- 1 tng25 tng25   23 Jan 28 01:08 __init__.py
drwxr-xr-x 2 tng25 tng25 4096 Jan 28 01:09 __pycache__
-rwxr-xr-x 1 tng25 tng25 2180 Jan 28 01:08 settings.py
-rwxr-xr-x 1 tng25 tng25 5076 Jan 26 03:17 settings.py.BACKUP_2026-01-26_031712.bak
-rwxr-xr-x 1 tng25 tng25 1270 Jan 12 08:11 settings.py.bak
-rwxr-xr-x 1 tng25 tng25 4205 Jan 20 20:25 settings.py.bak.1768937148
-rw-r--r-- 1 tng25 tng25 4205 Jan 24 14:36 settings.py.bak.mintcooldown.1769261817
-rwxr-xr-x 1 tng25 tng25 4573 Jan 25 23:00 settings.py.bak_2026-01-25_230047
-rwxr-xr-x 1 tng25 tng25 4901 Jan 26 00:47 settings.py.bak_2026-01-26_004739
-rwxr-xr-x 1 tng25 tng25 5609 Jan 26 05:03 settings.py.bak_2026-01-26_050341
-rwxr-xr-x 1 tng25 tng25 4379 Jan 25 14:57 settings.py.bak_deadmarket_2026-01-25_145723
-rwxr-xr-x 1 tng25 tng25 4742 Jan 26 00:22 settings.py.bak_defaults_2026-01-26_002213
-rwxr-xr-x 1 tng25 tng25 4742 Jan 26 00:22 settings.py.bak_defaults_2026-01-26_002224
-rwxr-xr-x 1 tng25 tng25 4742 Jan 26 00:28 settings.py.bak_scan_2026-01-26_002859
-rwxr-xr-x 1 tng25 tng25 4901 Jan 26 00:35 settings.py.bak_scanner_2026-01-26_003550
-rwxr-xr-x 1 tng25 tng25 5076 Jan 26 04:41 settings.py.bak_scanner_2026-01-26_044142
-rwxr-xr-x 1 tng25 tng25 4393 Jan 25 14:02 settings.py.bak_trailing_2026-01-25_140210
-rw-r--r-- 1 tng25 tng25 2875 Jan 27 03:53 src/config_legacy.py

### config/settings.py (head)
from __future__ import annotations

import os

def _env_bool(name: str, default: str = "0") -> bool:
    return (os.getenv(name, default) or "").strip().lower() in ("1","true","yes","on")

def _env_float(name: str, default: float) -> float:
    try:
        return float((os.getenv(name, "") or "").strip() or default)
    except Exception:
        return float(default)

def _env_int(name: str, default: int) -> int:
    try:
        return int((os.getenv(name, "") or "").strip() or default)
    except Exception:
        return int(default)

def _env_str(name: str, default: str = "") -> str:
    return (os.getenv(name, default) or default).strip()

# --- MODE / RPC ---
MODE = _env_str("MODE", "PAPER").upper()  # PAPER / REAL
RPC_URL = _env_str("RPC_URL", _env_str("RPC_HTTP", "https://api.mainnet-beta.solana.com"))

# --- Scanner ---
SCAN_INTERVAL_SECONDS = _env_int("SCAN_INTERVAL_SECONDS", 25)
NEW_LISTING_LIMIT = _env_int("NEW_LISTING_LIMIT", 5)
GLOBAL_RPS = _env_float("GLOBAL_RPS", 0.2)
MAX_CONCURRENCY = _env_int("MAX_CONCURRENCY", 1)

# --- Buy filters ---
BUY_AMOUNT_SOL = _env_float("BUY_AMOUNT_SOL", _env_float("TRADER_SOL_AMOUNT", 0.01))
BUY_COOLDOWN_SECONDS = _env_float("BUY_COOLDOWN_SECONDS", 0.0)
BUY_COOLDOWN_PER_MINT_SECONDS = _env_float("BUY_COOLDOWN_PER_MINT_SECONDS", 900.0)
BUY_COOLDOWN_AFTER_SELL_SECONDS = _env_float("BUY_COOLDOWN_AFTER_SELL_SECONDS", 900.0)
MAX_OPEN_POSITIONS = _env_int("MAX_OPEN_POSITIONS", 2)

MIN_PRICE_CHANGE_5M = _env_float("MIN_PRICE_CHANGE_5M", 6.0)
MIN_VOLUME_5M = _env_float("MIN_VOLUME_5M", 3000.0)
MIN_BUY_SELL_RATIO = _env_float("MIN_BUY_SELL_RATIO", 1.2)

# --- Anti-rug thresholds (defaults strict) ---
RISK_REQUIRE_RENOUNCED = _env_bool("RISK_REQUIRE_RENOUNCED", "1")
RISK_BLOCK_TOKEN_2022 = _env_bool("RISK_BLOCK_TOKEN_2022", "1")
RISK_MAX_TOP1_PCT = _env_float("RISK_MAX_TOP1_PCT", 0.25)   # 25%
RISK_MAX_TOP10_PCT = _env_float("RISK_MAX_TOP10_PCT", 0.60) # 60%
RISK_CACHE_TTL_SEC = _env_int("RISK_CACHE_TTL_SEC", 900)    # 15min

# --- Liquidity / marketcap (used by risk_checks.py) ---
MIN_LIQUIDITY_USD = _env_float("MIN_LIQUIDITY_USD", 15000.0)
MAX_MARKET_CAP_USD = _env_float("MAX_MARKET_CAP_USD", 300000.0)

### config/__init__.py
from . import settings

## 7) QUICK LINT: suspicious leftovers
core/solana_rpc_async.py:72:cat > /home/tng25/lino/core/risk_checks.py <<'PY'
core/solana_rpc_async.py:168:python3 - <<'PY'
core/solana_rpc_async.py:183:python3 - <<'PY'

## 8) PY COMPILE (surface errors)
  File "core/solana_rpc_async.py", line 69
    PY && \
        ^
SyntaxError: invalid syntax

## 9) STATE FILES (sizes only)
  286720  state/trades.sqlite
  105613  state/SKELETON_REPORT.txt
   88994  state/notes_dump.txt
   33909  state/backup_2026-01-28_010810/trading.py
   30002  state/universe_cache.json
   17023  state/blacklist_mint.json
    4245  state/backup_2026-01-28_010810/main.py
    2875  state/backup_2026-01-28_010810/config.py
    1132  state/backup_2026-01-28_010810/risk_checks.py
    1060  state/schema.sql
     461  state/blacklist_dev.json
     177  state/seed_mints.txt
     100  state/trader_loop_state.json

## 10) LAST GIT (if any)
(no git repo)

==== END REPORT ====
